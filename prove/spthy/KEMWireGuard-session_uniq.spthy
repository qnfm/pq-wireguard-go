theory PQWireGuard begin

// Function signature and definition of the equational theory E

builtins: xor
functions: adec/2, aead/3, aenc/2, decrypt/2, fst/1, h/1, pair/2,
           pk/1, prf/2, snd/1, true/0, verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    decrypt(aead(k, p, a), k) = p,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(aead(k, p, a), a, k) = true

heuristic: i

/* looping facts with injective instances: L_State/2 */

restriction Eq_testing:
  "∀ x y #i. (Eq( x, y ) @ #i) ⇒ (x = y)"
  // safety formula

restriction OnlyOnce:
  "∀ i r t #i.1 #j.
    ((OnlyOnce( i, r, t ) @ #i.1) ∧ (OnlyOnce( i, r, t ) @ #j)) ⇒
    (#i.1 = #j)"
  // safety formula

rule (modulo E) AgentKeyGen:
   [ Fr( ~ltk ) ]
  --[ StaticKey( pk(~ltk) ) ]->
   [ !F_AgentKey( ~ltk ), Out( pk(~ltk) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PSKKeyGen:
   [ Fr( ~psk ) ] --[ PSKey( ~psk ) ]-> [ !F_AgentPSK( ~psk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PRFKeyGen:
   [ Fr( ~k ) ] --[ PRFKey( ~k ) ]-> [ !F_AgentPRFK( ~k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DefaultPSKGen:
   [ !F_AgentKey( ~ltkA ), !F_AgentKey( ~ltkB ) ]
  --[
  DefaultPSK( pk(~ltkA), h((pk(~ltkA)⊕pk(~ltkB))) ),
  DefaultPSK( pk(~ltkB), h((pk(~ltkA)⊕pk(~ltkB))) ),
  Reveal_PSK( h((pk(~ltkA)⊕pk(~ltkB))) )
  ]->
   [
   Out( h((pk(~ltkA)⊕pk(~ltkB))) ),
   !F_AgenPSK( h((pk(~ltkA)⊕pk(~ltkB))) )
   ]

  /*
  rule (modulo AC) DefaultPSKGen:
     [ !F_AgentKey( ~ltkA ), !F_AgentKey( ~ltkB ) ]
    --[
    DefaultPSK( pk(~ltkA), h(z) ), DefaultPSK( pk(~ltkB), h(z) ),
    Reveal_PSK( h(z) )
    ]->
     [ Out( h(z) ), !F_AgenPSK( h(z) ) ]
    variants (modulo AC)
    1. ~ltkA = ~ltkA.4
       ~ltkB = ~ltkB.4
       z     = (pk(~ltkA.4)⊕pk(~ltkB.4))
    
    2. ~ltkA = ~x.4
       ~ltkB = ~x.4
       z     = zero
  */

rule (modulo E) PSK_reveal:
   [ !F_AgentPSK( k ) ] --[ Reveal_PSK( k ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) AgentKey_reveal:
   [ !F_AgentKey( k ) ] --[ Reveal_AK( pk(k) ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) EphKey_reveal:
   [ !F_AgentEphKey( k ) ] --[ Reveal_EphK( pk(k) ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rnd_reveal:
   [ !F_AgentRand( k ) ] --[ Reveal_rnd( k ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PRFK_reveal:
   [ !F_AgentPRFK( k ) ] --[ Reveal_prfk( k ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) AddPublicKey:
   [
   !F_AgentKey( ~ltkA ), !F_AgentKey( ~ltkB ), !F_AgentPSK( ~psk ),
   !F_AgentPRFK( ~tpk ), Fr( ~id )
   ]
  -->
   [
   L_State( ~id, 'no_message_state' ),
   !F_StateInvariants( ~id, ~psk, ~ltkA, pk(~ltkB), ~tpk )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Handshake_Init:
   [
   L_State( ~id, anything ),
   !F_StateInvariants( ~id, ~psk, ~ltkI, pkR, ~tpk ), Fr( ~r3 ),
   Fr( ~ekI ), Fr( ~sidI ), Fr( ~pkISurrogate )
   ]
  --[
  ISend( <pk(~ltkI), pkR, pk(~ekI), ~psk, prf(~tpk, ~r3)> ),
  Identity_Surrogate( ~pkISurrogate ), EphKey( ~ekI ),
  PRFGen( ~tpk, ~r3, prf(~tpk, ~r3) )
  ]->
   [
   L_State( ~id,
            <'init', ~sidI, ~ekI, 
             h(<
                h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                   prf(~tpk, ~r3), '1'>), 
                ~psk, '1'>), 
             h(<
                h(<h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>), 
                   aead(h(<
                           h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                              prf(~tpk, ~r3), '1'>), 
                           aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                   prf(~tpk, ~r3), '2'>),
                                <h(pk(~ltkI)), ~pkISurrogate>,
                                h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
                           '1'>),
                        pk(~ekI),
                        h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>))
                  >), 
                aead(h(<
                        h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                           prf(~tpk, ~r3), '1'>), 
                        ~psk, '2'>),
                     <$ts, 'TAI64N'>,
                     h(<h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>), 
                        aead(h(<
                                h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                   prf(~tpk, ~r3), '1'>), 
                                aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                        prf(~tpk, ~r3), '2'>),
                                     <h(pk(~ltkI)), ~pkISurrogate>,
                                     h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
                                '1'>),
                             pk(~ekI),
                             h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>))
                       >))
               >), 
             prf(~tpk, ~r3)>
   ),
   F_SolveInit( ~id, ~psk,
                <'init', ~sidI, ~ekI, 
                 h(<
                    h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                       prf(~tpk, ~r3), '1'>), 
                    ~psk, '1'>), 
                 h(<
                    h(<h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>), 
                       aead(h(<
                               h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                  prf(~tpk, ~r3), '1'>), 
                               aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                       prf(~tpk, ~r3), '2'>),
                                    <h(pk(~ltkI)), ~pkISurrogate>,
                                    h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
                               '1'>),
                            pk(~ekI),
                            h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>))
                      >), 
                    aead(h(<
                            h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                               prf(~tpk, ~r3), '1'>), 
                            ~psk, '2'>),
                         <$ts, 'TAI64N'>,
                         h(<h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>), 
                            aead(h(<
                                    h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                       prf(~tpk, ~r3), '1'>), 
                                    aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                            prf(~tpk, ~r3), '2'>),
                                         <h(pk(~ltkI)), ~pkISurrogate>,
                                         h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)
                                           >)), 
                                    '1'>),
                                 pk(~ekI),
                                 h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>))
                           >))
                   >), 
                 prf(~tpk, ~r3)>
   ),
   Out( <'1', ~sidI, aenc(prf(~tpk, ~r3), pkR), 
         aead(h(<
                 h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                    prf(~tpk, ~r3), '1'>), 
                 aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                         prf(~tpk, ~r3), '2'>),
                      <h(pk(~ltkI)), ~pkISurrogate>,
                      h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
                 '1'>),
              pk(~ekI),
              h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
         aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                 prf(~tpk, ~r3), '2'>),
              <h(pk(~ltkI)), ~pkISurrogate>,
              h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
         aead(h(<
                 h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                    prf(~tpk, ~r3), '1'>), 
                 ~psk, '2'>),
              <$ts, 'TAI64N'>,
              h(<h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>), 
                 aead(h(<
                         h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                            prf(~tpk, ~r3), '1'>), 
                         aead(h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pkR), '1'>), 
                                 prf(~tpk, ~r3), '2'>),
                              <h(pk(~ltkI)), ~pkISurrogate>,
                              h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>)), 
                         '1'>),
                      pk(~ekI),
                      h(<h(<h('noise'), 'id', pkR>), aenc(prf(~tpk, ~r3), pkR)>))
                >)), 
         $mac1, $mac2>
   ),
   !F_AgentEphKey( ~ekI ), !F_AgentRand( ~r3 )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) Handshake_Resp:
   [
   L_State( ~id, anything ),
   !F_StateInvariants( ~id, ~psk, ~ltkR, pkI, ~tpk ), Fr( ~sidR ),
   Fr( ~r1 ), Fr( ~r2 ),
   In( <'1', sidI, sct1, astat2, astat, ats, $mac1, $mac2> )
   ]
  --[
  RKeys( <pkI, pk(~ltkR), 
          decrypt(astat2,
                  h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), astat, 
                     '1'>)), 
          ~psk, 
          h(<
             h(<
                h(<
                   h(<
                      h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                         '1'>), 
                      aenc(prf(~tpk, ~r1), pkI), '1'>), 
                   prf(~tpk, ~r2), '1'>), 
                prf(~tpk, ~r1), '1'>), 
             ~psk, '1'>), 
          adec(sct1, ~ltkR), prf(~tpk, ~r1), prf(~tpk, ~r2)>
  ),
  Eq( fst(decrypt(astat,
                  h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '2'>))),
      h(pkI)
  ),
  Eq( snd(decrypt(ats,
                  h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                     '2'>))),
      'TAI64N'
  ),
  Eq( verify(astat, h(<h(<h('noise'), 'id', pk(~ltkR)>), sct1>),
             h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '2'>)),
      true
  ),
  Eq( verify(ats,
             h(<h(<h(<h('noise'), 'id', pk(~ltkR)>), sct1>), astat2>),
             h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                '2'>)),
      true
  ),
  OnlyOnce( pkI, pk(~ltkR),
            fst(decrypt(ats,
                        h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                           '2'>)))
  ),
  PRFGen( ~tpk, ~r1, prf(~tpk, ~r1) ),
  PRFGen( ~tpk, ~r2, prf(~tpk, ~r2) )
  ]->
   [
   L_State( ~id,
            <'transport_unconfirmed', ~sidR, 
             decrypt(astat2,
                     h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), astat, 
                        '1'>)), 
             h(<
                h(<
                   h(<
                      h(<
                         h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                            '1'>), 
                         aenc(prf(~tpk, ~r1), pkI), '1'>), 
                      prf(~tpk, ~r2), '1'>), 
                   prf(~tpk, ~r1), '1'>), 
                ~psk, '1'>), 
             adec(sct1, ~ltkR), prf(~tpk, ~r1), prf(~tpk, ~r2)>
   ),
   F_SolveResp( ~id, ~psk,
                <'transport_unconfirmed', ~sidR, 
                 decrypt(astat2,
                         h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), astat, 
                            '1'>)), 
                 h(<
                    h(<
                       h(<
                          h(<
                             h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                                '1'>), 
                             aenc(prf(~tpk, ~r1), pkI), '1'>), 
                          prf(~tpk, ~r2), '1'>), 
                       prf(~tpk, ~r1), '1'>), 
                    ~psk, '1'>), 
                 adec(sct1, ~ltkR), prf(~tpk, ~r1), prf(~tpk, ~r2)>
   ),
   Out( <'2', sidI, ~sidR, aenc(prf(~tpk, ~r1), pkI), 
         aenc(prf(~tpk, ~r2),
              decrypt(astat2,
                      h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), astat, 
                         '1'>))), 
         aead(h(<
                 h(<
                    h(<
                       h(<
                          h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                             '1'>), 
                          aenc(prf(~tpk, ~r1), pkI), '1'>), 
                       prf(~tpk, ~r2), '1'>), 
                    prf(~tpk, ~r1), '1'>), 
                 ~psk, '3'>),
              'e',
              h(<
                 h(<
                    h(<h(<h(<h(<h('noise'), 'id', pk(~ltkR)>), sct1>), astat2>), ats
                      >), 
                    aenc(prf(~tpk, ~r1), pkI)>), 
                 h(<
                    h(<
                       h(<
                          h(<
                             h(<h(<h(<h('noise'), sct1, '1'>), adec(sct1, ~ltkR), '1'>), ~psk, 
                                '1'>), 
                             aenc(prf(~tpk, ~r1), pkI), '1'>), 
                          prf(~tpk, ~r2), '1'>), 
                       prf(~tpk, ~r1), '1'>), 
                    ~psk, '2'>)
                >)), 
         $mac1, $mac2>
   ),
   !F_AgentRand( ~r1 ), !F_AgentRand( ~r2 )
   ]

  // loop breaker: [0]
  /*
  rule (modulo AC) Handshake_Resp:
     [
     L_State( ~id, anything ),
     !F_StateInvariants( ~id, ~psk, ~ltkR, pkI, ~tpk ), Fr( ~sidR ),
     Fr( ~r1 ), Fr( ~r2 ),
     In( <'1', sidI, sct1, astat2, astat, ats, $mac1, $mac2> )
     ]
    --[
    RKeys( <pkI, pk(~ltkR), z, ~psk, 
            h(<
               h(<
                  h(<
                     h(<h(<h(<h(<h('noise'), sct1, '1'>), z.1, '1'>), ~psk, '1'>), 
                        aenc(prf(~tpk, ~r1), pkI), '1'>), 
                     prf(~tpk, ~r2), '1'>), 
                  prf(~tpk, ~r1), '1'>), 
               ~psk, '1'>), 
            z.1, prf(~tpk, ~r1), prf(~tpk, ~r2)>
    ),
    Eq( z.2, h(pkI) ), Eq( z.3, 'TAI64N' ), Eq( z.4, true ),
    Eq( z.5, true ), OnlyOnce( pkI, pk(~ltkR), z.6 ),
    PRFGen( ~tpk, ~r1, prf(~tpk, ~r1) ),
    PRFGen( ~tpk, ~r2, prf(~tpk, ~r2) )
    ]->
     [
     L_State( ~id,
              <'transport_unconfirmed', ~sidR, z, 
               h(<
                  h(<
                     h(<
                        h(<h(<h(<h(<h('noise'), sct1, '1'>), z.1, '1'>), ~psk, '1'>), 
                           aenc(prf(~tpk, ~r1), pkI), '1'>), 
                        prf(~tpk, ~r2), '1'>), 
                     prf(~tpk, ~r1), '1'>), 
                  ~psk, '1'>), 
               z.1, prf(~tpk, ~r1), prf(~tpk, ~r2)>
     ),
     F_SolveResp( ~id, ~psk,
                  <'transport_unconfirmed', ~sidR, z, 
                   h(<
                      h(<
                         h(<
                            h(<h(<h(<h(<h('noise'), sct1, '1'>), z.1, '1'>), ~psk, '1'>), 
                               aenc(prf(~tpk, ~r1), pkI), '1'>), 
                            prf(~tpk, ~r2), '1'>), 
                         prf(~tpk, ~r1), '1'>), 
                      ~psk, '1'>), 
                   z.1, prf(~tpk, ~r1), prf(~tpk, ~r2)>
     ),
     Out( <'2', sidI, ~sidR, aenc(prf(~tpk, ~r1), pkI), 
           aenc(prf(~tpk, ~r2), z), 
           aead(h(<
                   h(<
                      h(<
                         h(<h(<h(<h(<h('noise'), sct1, '1'>), z.1, '1'>), ~psk, '1'>), 
                            aenc(prf(~tpk, ~r1), pkI), '1'>), 
                         prf(~tpk, ~r2), '1'>), 
                      prf(~tpk, ~r1), '1'>), 
                   ~psk, '3'>),
                'e',
                h(<
                   h(<
                      h(<h(<h(<h(<h('noise'), 'id', pk(~ltkR)>), sct1>), astat2>), ats
                        >), 
                      aenc(prf(~tpk, ~r1), pkI)>), 
                   h(<
                      h(<
                         h(<
                            h(<h(<h(<h(<h('noise'), sct1, '1'>), z.1, '1'>), ~psk, '1'>), 
                               aenc(prf(~tpk, ~r1), pkI), '1'>), 
                            prf(~tpk, ~r2), '1'>), 
                         prf(~tpk, ~r1), '1'>), 
                      ~psk, '2'>)
                  >)), 
           $mac1, $mac2>
     ),
     !F_AgentRand( ~r1 ), !F_AgentRand( ~r2 )
     ]
    variants (modulo AC)
      1. ~ltkR = ~ltkR.44
         ~psk  = ~psk.45
         astat = astat.51
         astat2
               = astat2.52
         ats   = ats.53
         sct1  = sct1.55
         z     = decrypt(astat2.52,
                         h(<
                            h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '1'>), 
                            astat.51, '1'>))
         z.1   = adec(sct1.55, ~ltkR.44)
         z.2   = fst(decrypt(astat.51,
                             h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '2'>)))
         z.3   = snd(decrypt(ats.53,
                             h(<
                                h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '1'>), 
                                ~psk.45, '2'>)))
         z.4   = verify(astat.51,
                        h(<h(<h('noise'), 'id', pk(~ltkR.44)>), sct1.55>),
                        h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '2'>))
         z.5   = verify(ats.53,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.44)>), sct1.55>), astat2.52>),
                        h(<
                           h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '1'>), 
                           ~psk.45, '2'>))
         z.6   = fst(decrypt(ats.53,
                             h(<
                                h(<h(<h('noise'), sct1.55, '1'>), adec(sct1.55, ~ltkR.44), '1'>), 
                                ~psk.45, '2'>)))
    
      2. ~ltkR = ~ltkR.50
         ~psk  = ~psk.51
         astat = astat.57
         astat2
               = astat2.58
         ats   = ats.59
         sct1  = aenc(z.67, pk(~ltkR.50))
         z     = decrypt(astat2.58,
                         h(<h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '1'>), 
                            astat.57, '1'>))
         z.1   = z.67
         z.2   = fst(decrypt(astat.57,
                             h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '2'>)))
         z.3   = snd(decrypt(ats.59,
                             h(<h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '1'>), 
                                ~psk.51, '2'>)))
         z.4   = verify(astat.57,
                        h(<h(<h('noise'), 'id', pk(~ltkR.50)>), aenc(z.67, pk(~ltkR.50))>),
                        h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '2'>))
         z.5   = verify(ats.59,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.50)>), aenc(z.67, pk(~ltkR.50))
                             >), 
                           astat2.58>),
                        h(<h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '1'>), 
                           ~psk.51, '2'>))
         z.6   = fst(decrypt(ats.59,
                             h(<h(<h(<h('noise'), aenc(z.67, pk(~ltkR.50)), '1'>), z.67, '1'>), 
                                ~psk.51, '2'>)))
    
      3. ~ltkR = ~ltkR.60
         ~psk  = ~psk.61
         astat = astat.67
         astat2
               = astat2.68
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.71, '1'>), adec(sct1.71, ~ltkR.60), '1'>), 
                         ~psk.61, '2'>),
                      <z.87, z.83>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.60)>), sct1.71>), astat2.68>))
         sct1  = sct1.71
         z     = decrypt(astat2.68,
                         h(<
                            h(<h(<h('noise'), sct1.71, '1'>), adec(sct1.71, ~ltkR.60), '1'>), 
                            astat.67, '1'>))
         z.1   = adec(sct1.71, ~ltkR.60)
         z.2   = fst(decrypt(astat.67,
                             h(<h(<h('noise'), sct1.71, '1'>), adec(sct1.71, ~ltkR.60), '2'>)))
         z.3   = z.83
         z.4   = verify(astat.67,
                        h(<h(<h('noise'), 'id', pk(~ltkR.60)>), sct1.71>),
                        h(<h(<h('noise'), sct1.71, '1'>), adec(sct1.71, ~ltkR.60), '2'>))
         z.5   = true
         z.6   = z.87
    
      4. ~ltkR = ~ltkR.60
         ~psk  = ~psk.61
         astat = astat.67
         astat2
               = astat2.68
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.77, pk(~ltkR.60)), '1'>), z.77, '1'>), 
                         ~psk.61, '2'>),
                      <z.87, z.83>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.60)>), aenc(z.77, pk(~ltkR.60))
                           >), 
                         astat2.68>))
         sct1  = aenc(z.77, pk(~ltkR.60))
         z     = decrypt(astat2.68,
                         h(<h(<h(<h('noise'), aenc(z.77, pk(~ltkR.60)), '1'>), z.77, '1'>), 
                            astat.67, '1'>))
         z.1   = z.77
         z.2   = fst(decrypt(astat.67,
                             h(<h(<h('noise'), aenc(z.77, pk(~ltkR.60)), '1'>), z.77, '2'>)))
         z.3   = z.83
         z.4   = verify(astat.67,
                        h(<h(<h('noise'), 'id', pk(~ltkR.60)>), aenc(z.77, pk(~ltkR.60))>),
                        h(<h(<h('noise'), aenc(z.77, pk(~ltkR.60)), '1'>), z.77, '2'>))
         z.5   = true
         z.6   = z.87
    
      5. ~ltkR = ~ltkR.237
         ~psk  = ~psk.238
         astat = aead(h(<h(<h('noise'), sct1.248, '1'>), 
                         adec(sct1.248, ~ltkR.237), '2'>),
                      x.469, h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>))
         astat2
               = astat2.245
         ats   = ats.246
         sct1  = sct1.248
         z     = decrypt(astat2.245,
                         h(<
                            h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), 
                                    '2'>),
                                 x.469, h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>)), 
                            '1'>))
         z.1   = adec(sct1.248, ~ltkR.237)
         z.2   = fst(x.469)
         z.3   = snd(decrypt(ats.246,
                             h(<
                                h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                                  >), 
                                ~psk.238, '2'>)))
         z.4   = true
         z.5   = verify(ats.246,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>), astat2.245
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                             >), 
                           ~psk.238, '2'>))
         z.6   = fst(decrypt(ats.246,
                             h(<
                                h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                                  >), 
                                ~psk.238, '2'>)))
    
      6. ~ltkR = ~ltkR.237
         ~psk  = ~psk.238
         astat = aead(h(<h(<h('noise'), sct1.248, '1'>), 
                         adec(sct1.248, ~ltkR.237), '2'>),
                      x.469, h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>))
         astat2
               = astat2.245
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                           >), 
                         ~psk.238, '2'>),
                      <z.264, z.260>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>), astat2.245
                        >))
         sct1  = sct1.248
         z     = decrypt(astat2.245,
                         h(<
                            h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.248, '1'>), adec(sct1.248, ~ltkR.237), 
                                    '2'>),
                                 x.469, h(<h(<h('noise'), 'id', pk(~ltkR.237)>), sct1.248>)), 
                            '1'>))
         z.1   = adec(sct1.248, ~ltkR.237)
         z.2   = fst(x.469)
         z.3   = z.260
         z.4   = true
         z.5   = true
         z.6   = z.264
    
      7. ~ltkR = ~ltkR.237
         ~psk  = ~psk.238
         astat = aead(h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), 
                         z.254, '2'>),
                      x.469,
                      h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                        >))
         astat2
               = astat2.245
         ats   = ats.246
         sct1  = aenc(z.254, pk(~ltkR.237))
         z     = decrypt(astat2.245,
                         h(<
                            h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, 
                                    '2'>),
                                 x.469,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                                   >)), 
                            '1'>))
         z.1   = z.254
         z.2   = fst(x.469)
         z.3   = snd(decrypt(ats.246,
                             h(<
                                h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                                ~psk.238, '2'>)))
         z.4   = true
         z.5   = verify(ats.246,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                             >), 
                           astat2.245>),
                        h(<
                           h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                           ~psk.238, '2'>))
         z.6   = fst(decrypt(ats.246,
                             h(<
                                h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                                ~psk.238, '2'>)))
    
      8. ~ltkR = ~ltkR.237
         ~psk  = ~psk.238
         astat = aead(h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), 
                         z.254, '2'>),
                      x.469,
                      h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                        >))
         astat2
               = astat2.245
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                         ~psk.238, '2'>),
                      <z.264, z.260>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                           >), 
                         astat2.245>))
         sct1  = aenc(z.254, pk(~ltkR.237))
         z     = decrypt(astat2.245,
                         h(<
                            h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.254, pk(~ltkR.237)), '1'>), z.254, 
                                    '2'>),
                                 x.469,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.237)>), aenc(z.254, pk(~ltkR.237))
                                   >)), 
                            '1'>))
         z.1   = z.254
         z.2   = fst(x.469)
         z.3   = z.260
         z.4   = true
         z.5   = true
         z.6   = z.264
    
      9. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), sct1.249, '1'>), 
                         adec(sct1.249, ~ltkR.238), '2'>),
                      x.470, x.471)
         astat2
               = astat2.246
         ats   = ats.247
         sct1  = sct1.249
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), 
                                    '2'>),
                                 x.470, x.471), 
                            '1'>))
         z.1   = adec(sct1.249, ~ltkR.238)
         z.2   = fst(x.470)
         z.3   = snd(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                                  >), 
                                ~psk.239, '2'>)))
         z.4   = verify(aead(h(<h(<h('noise'), sct1.249, '1'>), 
                                adec(sct1.249, ~ltkR.238), '2'>),
                             x.470, x.471),
                        h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>),
                        h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '2'
                          >))
         z.5   = verify(ats.247,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>), astat2.246
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                             >), 
                           ~psk.239, '2'>))
         z.6   = fst(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                                  >), 
                                ~psk.239, '2'>)))
    
     10. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), sct1.249, '1'>), 
                         adec(sct1.249, ~ltkR.238), '2'>),
                      x.470, x.471)
         astat2
               = astat2.246
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                           >), 
                         ~psk.239, '2'>),
                      <z.265, z.261>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>), astat2.246
                        >))
         sct1  = sct1.249
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), 
                                    '2'>),
                                 x.470, x.471), 
                            '1'>))
         z.1   = adec(sct1.249, ~ltkR.238)
         z.2   = fst(x.470)
         z.3   = z.261
         z.4   = verify(aead(h(<h(<h('noise'), sct1.249, '1'>), 
                                adec(sct1.249, ~ltkR.238), '2'>),
                             x.470, x.471),
                        h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>),
                        h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '2'
                          >))
         z.5   = true
         z.6   = z.265
    
     11. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), sct1.249, '1'>), 
                         adec(sct1.249, ~ltkR.238), '2'>),
                      <z.260, x.471>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>))
         astat2
               = astat2.246
         ats   = ats.247
         sct1  = sct1.249
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), 
                                    '2'>),
                                 <z.260, x.471>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>)), 
                            '1'>))
         z.1   = adec(sct1.249, ~ltkR.238)
         z.2   = z.260
         z.3   = snd(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                                  >), 
                                ~psk.239, '2'>)))
         z.4   = true
         z.5   = verify(ats.247,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>), astat2.246
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                             >), 
                           ~psk.239, '2'>))
         z.6   = fst(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                                  >), 
                                ~psk.239, '2'>)))
    
     12. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), sct1.249, '1'>), 
                         adec(sct1.249, ~ltkR.238), '2'>),
                      <z.260, x.471>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>))
         astat2
               = astat2.246
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                           >), 
                         ~psk.239, '2'>),
                      <z.265, z.261>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>), astat2.246
                        >))
         sct1  = sct1.249
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.249, '1'>), adec(sct1.249, ~ltkR.238), 
                                    '2'>),
                                 <z.260, x.471>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.238)>), sct1.249>)), 
                            '1'>))
         z.1   = adec(sct1.249, ~ltkR.238)
         z.2   = z.260
         z.3   = z.261
         z.4   = true
         z.5   = true
         z.6   = z.265
    
     13. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), 
                         z.255, '2'>),
                      x.470, x.471)
         astat2
               = astat2.246
         ats   = ats.247
         sct1  = aenc(z.255, pk(~ltkR.238))
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, 
                                    '2'>),
                                 x.470, x.471), 
                            '1'>))
         z.1   = z.255
         z.2   = fst(x.470)
         z.3   = snd(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                                ~psk.239, '2'>)))
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '2'>),
                             x.470, x.471),
                        h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                          >),
                        h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '2'>))
         z.5   = verify(ats.247,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                             >), 
                           astat2.246>),
                        h(<
                           h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                           ~psk.239, '2'>))
         z.6   = fst(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                                ~psk.239, '2'>)))
    
     14. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), 
                         z.255, '2'>),
                      x.470, x.471)
         astat2
               = astat2.246
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                         ~psk.239, '2'>),
                      <z.265, z.261>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                           >), 
                         astat2.246>))
         sct1  = aenc(z.255, pk(~ltkR.238))
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, 
                                    '2'>),
                                 x.470, x.471), 
                            '1'>))
         z.1   = z.255
         z.2   = fst(x.470)
         z.3   = z.261
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '2'>),
                             x.470, x.471),
                        h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                          >),
                        h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '2'>))
         z.5   = true
         z.6   = z.265
    
     15. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), 
                         z.255, '2'>),
                      <z.260, x.471>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                        >))
         astat2
               = astat2.246
         ats   = ats.247
         sct1  = aenc(z.255, pk(~ltkR.238))
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, 
                                    '2'>),
                                 <z.260, x.471>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                                   >)), 
                            '1'>))
         z.1   = z.255
         z.2   = z.260
         z.3   = snd(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                                ~psk.239, '2'>)))
         z.4   = true
         z.5   = verify(ats.247,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                             >), 
                           astat2.246>),
                        h(<
                           h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                           ~psk.239, '2'>))
         z.6   = fst(decrypt(ats.247,
                             h(<
                                h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                                ~psk.239, '2'>)))
    
     16. ~ltkR = ~ltkR.238
         ~psk  = ~psk.239
         astat = aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), 
                         z.255, '2'>),
                      <z.260, x.471>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                        >))
         astat2
               = astat2.246
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                         ~psk.239, '2'>),
                      <z.265, z.261>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                           >), 
                         astat2.246>))
         sct1  = aenc(z.255, pk(~ltkR.238))
         z     = decrypt(astat2.246,
                         h(<
                            h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.255, pk(~ltkR.238)), '1'>), z.255, 
                                    '2'>),
                                 <z.260, x.471>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.238)>), aenc(z.255, pk(~ltkR.238))
                                   >)), 
                            '1'>))
         z.1   = z.255
         z.2   = z.260
         z.3   = z.261
         z.4   = true
         z.5   = true
         z.6   = z.265
    
     17. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         ~psk.240, '2'>),
                      x.473,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), astat2.247
                        >))
         sct1  = sct1.250
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                              >), 
                            astat.246, '1'>))
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                               >)))
         z.3   = snd(x.473)
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>),
                        h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                          >))
         z.5   = true
         z.6   = fst(x.473)
    
     18. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         ~psk.240, '2'>),
                      x.473,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                           >), 
                         astat2.247>))
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                            astat.246, '1'>))
         z.1   = z.256
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>)))
         z.3   = snd(x.473)
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                          >),
                        h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>))
         z.5   = true
         z.6   = fst(x.473)
    
     19. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         astat.246, '1'>),
                      z.254, x.473)
         ats   = ats.248
         sct1  = sct1.250
         z     = z.254
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                               >)))
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>),
                        h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                          >))
         z.5   = verify(ats.248,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                     >), 
                                   astat.246, '1'>),
                                z.254, x.473)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                             >), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
    
     20. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         astat.246, '1'>),
                      z.254, x.473)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                   >), 
                                 astat.246, '1'>),
                              z.254, x.473)
                        >))
         sct1  = sct1.250
         z     = z.254
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                               >)))
         z.3   = z.262
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>),
                        h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                          >))
         z.5   = true
         z.6   = z.266
    
     21. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         astat.246, '1'>),
                      z.254, x.473)
         ats   = ats.248
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = z.254
         z.1   = z.256
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>)))
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                          >),
                        h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>))
         z.5   = verify(ats.248,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'
                                     >), 
                                   astat.246, '1'>),
                                z.254, x.473)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
    
     22. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = astat.246
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         astat.246, '1'>),
                      z.254, x.473)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                 astat.246, '1'>),
                              z.254, x.473)
                        >))
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = z.254
         z.1   = z.256
         z.2   = fst(decrypt(astat.246,
                             h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>)))
         z.3   = z.262
         z.4   = verify(astat.246,
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                          >),
                        h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>))
         z.5   = true
         z.6   = z.266
    
     23. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), sct1.250, '1'>), 
                         adec(sct1.250, ~ltkR.239), '2'>),
                      x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>))
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         ~psk.240, '2'>),
                      x.473,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), astat2.247
                        >))
         sct1  = sct1.250
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                    '2'>),
                                 x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>)), 
                            '1'>))
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(x.471)
         z.3   = snd(x.473)
         z.4   = true
         z.5   = true
         z.6   = fst(x.473)
    
     24. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), sct1.250, '1'>), 
                         adec(sct1.250, ~ltkR.239), '2'>),
                      x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                 '2'>),
                              x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>)), 
                         '1'>),
                      z.254, x.473)
         ats   = ats.248
         sct1  = sct1.250
         z     = z.254
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(x.471)
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
         z.4   = true
         z.5   = verify(ats.248,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.250, '1'>), 
                                           adec(sct1.250, ~ltkR.239), '2'>),
                                        x.471,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>)), 
                                   '1'>),
                                z.254, x.473)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                             >), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
    
     25. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), sct1.250, '1'>), 
                         adec(sct1.250, ~ltkR.239), '2'>),
                      x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                 '2'>),
                              x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>)), 
                         '1'>),
                      z.254, x.473)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                         '2'>),
                                      x.471, h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>)), 
                                 '1'>),
                              z.254, x.473)
                        >))
         sct1  = sct1.250
         z     = z.254
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = fst(x.471)
         z.3   = z.262
         z.4   = true
         z.5   = true
         z.6   = z.266
    
     26. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), sct1.250, '1'>), 
                         adec(sct1.250, ~ltkR.239), '2'>),
                      <z.261, x.472>, x.473)
         astat2
               = astat2.247
         ats   = ats.248
         sct1  = sct1.250
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                    '2'>),
                                 <z.261, x.472>, x.473), 
                            '1'>))
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = z.261
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
         z.4   = verify(aead(h(<h(<h('noise'), sct1.250, '1'>), 
                                adec(sct1.250, ~ltkR.239), '2'>),
                             <z.261, x.472>, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>),
                        h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                          >))
         z.5   = verify(ats.248,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), astat2.247
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                             >), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                                  >), 
                                ~psk.240, '2'>)))
    
     27. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), sct1.250, '1'>), 
                         adec(sct1.250, ~ltkR.239), '2'>),
                      <z.261, x.472>, x.473)
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                           >), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>), astat2.247
                        >))
         sct1  = sct1.250
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), 
                                    '2'>),
                                 <z.261, x.472>, x.473), 
                            '1'>))
         z.1   = adec(sct1.250, ~ltkR.239)
         z.2   = z.261
         z.3   = z.262
         z.4   = verify(aead(h(<h(<h('noise'), sct1.250, '1'>), 
                                adec(sct1.250, ~ltkR.239), '2'>),
                             <z.261, x.472>, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), sct1.250>),
                        h(<h(<h('noise'), sct1.250, '1'>), adec(sct1.250, ~ltkR.239), '2'
                          >))
         z.5   = true
         z.6   = z.266
    
     28. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), 
                         z.256, '2'>),
                      x.471,
                      h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                        >))
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         ~psk.240, '2'>),
                      x.473,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                           >), 
                         astat2.247>))
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                    '2'>),
                                 x.471,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                                   >)), 
                            '1'>))
         z.1   = z.256
         z.2   = fst(x.471)
         z.3   = snd(x.473)
         z.4   = true
         z.5   = true
         z.6   = fst(x.473)
    
     29. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), 
                         z.256, '2'>),
                      x.471,
                      h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                 '2'>),
                              x.471,
                              h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                                >)), 
                         '1'>),
                      z.254, x.473)
         ats   = ats.248
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = z.254
         z.1   = z.256
         z.2   = fst(x.471)
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
         z.4   = true
         z.5   = verify(ats.248,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                           '2'>),
                                        x.471,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), 
                                           aenc(z.256, pk(~ltkR.239))>)), 
                                   '1'>),
                                z.254, x.473)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
    
     30. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), 
                         z.256, '2'>),
                      x.471,
                      h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                 '2'>),
                              x.471,
                              h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                                >)), 
                         '1'>),
                      z.254, x.473)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                         '2'>),
                                      x.471,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.239)>), 
                                         aenc(z.256, pk(~ltkR.239))>)), 
                                 '1'>),
                              z.254, x.473)
                        >))
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = z.254
         z.1   = z.256
         z.2   = fst(x.471)
         z.3   = z.262
         z.4   = true
         z.5   = true
         z.6   = z.266
    
     31. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), 
                         z.256, '2'>),
                      <z.261, x.472>, x.473)
         astat2
               = astat2.247
         ats   = ats.248
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                    '2'>),
                                 <z.261, x.472>, x.473), 
                            '1'>))
         z.1   = z.256
         z.2   = z.261
         z.3   = snd(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>),
                             <z.261, x.472>, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                          >),
                        h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>))
         z.5   = verify(ats.248,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                             >), 
                           astat2.247>),
                        h(<
                           h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                           ~psk.240, '2'>))
         z.6   = fst(decrypt(ats.248,
                             h(<
                                h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                                ~psk.240, '2'>)))
    
     32. ~ltkR = ~ltkR.239
         ~psk  = ~psk.240
         astat = aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), 
                         z.256, '2'>),
                      <z.261, x.472>, x.473)
         astat2
               = astat2.247
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                         ~psk.240, '2'>),
                      <z.266, z.262>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                           >), 
                         astat2.247>))
         sct1  = aenc(z.256, pk(~ltkR.239))
         z     = decrypt(astat2.247,
                         h(<
                            h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, 
                                    '2'>),
                                 <z.261, x.472>, x.473), 
                            '1'>))
         z.1   = z.256
         z.2   = z.261
         z.3   = z.262
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>),
                             <z.261, x.472>, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.239)>), aenc(z.256, pk(~ltkR.239))
                          >),
                        h(<h(<h('noise'), aenc(z.256, pk(~ltkR.239)), '1'>), z.256, '2'>))
         z.5   = true
         z.6   = z.266
    
     33. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = astat.247
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.474, x.475)
         sct1  = sct1.251
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                              >), 
                            astat.247, '1'>))
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(decrypt(astat.247,
                             h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                               >)))
         z.3   = snd(x.474)
         z.4   = verify(astat.247,
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>),
                        h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>),
                             x.474, x.475),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), astat2.248
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                             >), 
                           ~psk.241, '2'>))
         z.6   = fst(x.474)
    
     34. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = astat.247
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.474, x.475)
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                            astat.247, '1'>))
         z.1   = z.257
         z.2   = fst(decrypt(astat.247,
                             h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>)))
         z.3   = snd(x.474)
         z.4   = verify(astat.247,
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                          >),
                        h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>),
                             x.474, x.475),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                             >), 
                           astat2.248>),
                        h(<
                           h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                           ~psk.241, '2'>))
         z.6   = fst(x.474)
    
     35. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = astat.247
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         astat.247, '1'>),
                      z.255, x.474)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                   >), 
                                 astat.247, '1'>),
                              z.255, x.474)
                        >))
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(decrypt(astat.247,
                             h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                               >)))
         z.3   = snd(x.475)
         z.4   = verify(astat.247,
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>),
                        h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                          >))
         z.5   = true
         z.6   = fst(x.475)
    
     36. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = astat.247
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         astat.247, '1'>),
                      z.255, x.474)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                 astat.247, '1'>),
                              z.255, x.474)
                        >))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = fst(decrypt(astat.247,
                             h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>)))
         z.3   = snd(x.475)
         z.4   = verify(astat.247,
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                          >),
                        h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>))
         z.5   = true
         z.6   = fst(x.475)
    
     37. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      x.472, x.473)
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), astat2.248
                        >))
         sct1  = sct1.251
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                    '2'>),
                                 x.472, x.473), 
                            '1'>))
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(x.472)
         z.3   = snd(x.475)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.251, '1'>), 
                                adec(sct1.251, ~ltkR.240), '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>),
                        h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                          >))
         z.5   = true
         z.6   = fst(x.475)
    
     38. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      x.472, x.473)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                 '2'>),
                              x.472, x.473), 
                         '1'>),
                      z.255, x.475)
         ats   = ats.249
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(x.472)
         z.3   = snd(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>)))
         z.4   = verify(aead(h(<h(<h('noise'), sct1.251, '1'>), 
                                adec(sct1.251, ~ltkR.240), '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>),
                        h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                          >))
         z.5   = verify(ats.249,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.251, '1'>), 
                                           adec(sct1.251, ~ltkR.240), '2'>),
                                        x.472, x.473), 
                                   '1'>),
                                z.255, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                             >), 
                           ~psk.241, '2'>))
         z.6   = fst(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>)))
    
     39. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      x.472, x.473)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                 '2'>),
                              x.472, x.473), 
                         '1'>),
                      z.255, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      <z.267, z.263>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                         '2'>),
                                      x.472, x.473), 
                                 '1'>),
                              z.255, x.475)
                        >))
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(x.472)
         z.3   = z.263
         z.4   = verify(aead(h(<h(<h('noise'), sct1.251, '1'>), 
                                adec(sct1.251, ~ltkR.240), '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>),
                        h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '2'
                          >))
         z.5   = true
         z.6   = z.267
    
     40. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      x.472, h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>))
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.474, x.475)
         sct1  = sct1.251
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                    '2'>),
                                 x.472, h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                            '1'>))
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(x.472)
         z.3   = snd(x.474)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>),
                             x.474, x.475),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), astat2.248
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                             >), 
                           ~psk.241, '2'>))
         z.6   = fst(x.474)
    
     41. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      x.472, h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                 '2'>),
                              x.472, h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                         '1'>),
                      z.255, x.474)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                         '2'>),
                                      x.472, h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                                 '1'>),
                              z.255, x.474)
                        >))
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = fst(x.472)
         z.3   = snd(x.475)
         z.4   = true
         z.5   = true
         z.6   = fst(x.475)
    
     42. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>))
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), astat2.248
                        >))
         sct1  = sct1.251
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                    '2'>),
                                 <z.262, x.473>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                            '1'>))
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = z.262
         z.3   = snd(x.475)
         z.4   = true
         z.5   = true
         z.6   = fst(x.475)
    
     43. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                 '2'>),
                              <z.262, x.473>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                         '1'>),
                      z.255, x.475)
         ats   = ats.249
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = z.262
         z.3   = snd(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>)))
         z.4   = true
         z.5   = verify(ats.249,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.251, '1'>), 
                                           adec(sct1.251, ~ltkR.240), '2'>),
                                        <z.262, x.473>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                                   '1'>),
                                z.255, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                             >), 
                           ~psk.241, '2'>))
         z.6   = fst(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                  >), 
                                ~psk.241, '2'>)))
    
     44. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), sct1.251, '1'>), 
                         adec(sct1.251, ~ltkR.240), '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                 '2'>),
                              <z.262, x.473>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                         '1'>),
                      z.255, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                           >), 
                         ~psk.241, '2'>),
                      <z.267, z.263>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.251, '1'>), adec(sct1.251, ~ltkR.240), 
                                         '2'>),
                                      <z.262, x.473>,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), sct1.251>)), 
                                 '1'>),
                              z.255, x.475)
                        >))
         sct1  = sct1.251
         z     = z.255
         z.1   = adec(sct1.251, ~ltkR.240)
         z.2   = z.262
         z.3   = z.263
         z.4   = true
         z.5   = true
         z.6   = z.267
    
     45. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      x.472, x.473)
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         astat2.248>))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                    '2'>),
                                 x.472, x.473), 
                            '1'>))
         z.1   = z.257
         z.2   = fst(x.472)
         z.3   = snd(x.475)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                          >),
                        h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>))
         z.5   = true
         z.6   = fst(x.475)
    
     46. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      x.472, x.473)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                 '2'>),
                              x.472, x.473), 
                         '1'>),
                      z.255, x.475)
         ats   = ats.249
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = fst(x.472)
         z.3   = snd(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>)))
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                          >),
                        h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>))
         z.5   = verify(ats.249,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                           '2'>),
                                        x.472, x.473), 
                                   '1'>),
                                z.255, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                           ~psk.241, '2'>))
         z.6   = fst(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>)))
    
     47. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      x.472, x.473)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                 '2'>),
                              x.472, x.473), 
                         '1'>),
                      z.255, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      <z.267, z.263>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                         '2'>),
                                      x.472, x.473), 
                                 '1'>),
                              z.255, x.475)
                        >))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = fst(x.472)
         z.3   = z.263
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>),
                             x.472, x.473),
                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                          >),
                        h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '2'>))
         z.5   = true
         z.6   = z.267
    
     48. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      x.472,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                        >))
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.474, x.475)
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                    '2'>),
                                 x.472,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                                   >)), 
                            '1'>))
         z.1   = z.257
         z.2   = fst(x.472)
         z.3   = snd(x.474)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>),
                             x.474, x.475),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                             >), 
                           astat2.248>),
                        h(<
                           h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                           ~psk.241, '2'>))
         z.6   = fst(x.474)
    
     49. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      x.472,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                 '2'>),
                              x.472,
                              h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                                >)), 
                         '1'>),
                      z.255, x.474)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                         '2'>),
                                      x.472,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), 
                                         aenc(z.257, pk(~ltkR.240))>)), 
                                 '1'>),
                              z.255, x.474)
                        >))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = fst(x.472)
         z.3   = snd(x.475)
         z.4   = true
         z.5   = true
         z.6   = fst(x.475)
    
     50. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                        >))
         astat2
               = astat2.248
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      x.475,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         astat2.248>))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = decrypt(astat2.248,
                         h(<
                            h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                    '2'>),
                                 <z.262, x.473>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                                   >)), 
                            '1'>))
         z.1   = z.257
         z.2   = z.262
         z.3   = snd(x.475)
         z.4   = true
         z.5   = true
         z.6   = fst(x.475)
    
     51. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                 '2'>),
                              <z.262, x.473>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                                >)), 
                         '1'>),
                      z.255, x.475)
         ats   = ats.249
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = z.262
         z.3   = snd(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>)))
         z.4   = true
         z.5   = verify(ats.249,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                           '2'>),
                                        <z.262, x.473>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.240)>), 
                                           aenc(z.257, pk(~ltkR.240))>)), 
                                   '1'>),
                                z.255, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                           ~psk.241, '2'>))
         z.6   = fst(decrypt(ats.249,
                             h(<
                                h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                ~psk.241, '2'>)))
    
     52. ~ltkR = ~ltkR.240
         ~psk  = ~psk.241
         astat = aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), 
                         z.257, '2'>),
                      <z.262, x.473>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                 '2'>),
                              <z.262, x.473>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                                >)), 
                         '1'>),
                      z.255, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                         ~psk.241, '2'>),
                      <z.267, z.263>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.240)>), aenc(z.257, pk(~ltkR.240))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.257, pk(~ltkR.240)), '1'>), z.257, 
                                         '2'>),
                                      <z.262, x.473>,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.240)>), 
                                         aenc(z.257, pk(~ltkR.240))>)), 
                                 '1'>),
                              z.255, x.475)
                        >))
         sct1  = aenc(z.257, pk(~ltkR.240))
         z     = z.255
         z.1   = z.257
         z.2   = z.262
         z.3   = z.263
         z.4   = true
         z.5   = true
         z.6   = z.267
    
     53. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = astat.248
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      <z.268, z.264>, x.477)
         sct1  = sct1.252
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                              >), 
                            astat.248, '1'>))
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(decrypt(astat.248,
                             h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                               >)))
         z.3   = z.264
         z.4   = verify(astat.248,
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             <z.268, z.264>, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), astat2.249
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = z.268
    
     54. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = astat.248
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      <z.268, z.264>, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                            astat.248, '1'>))
         z.1   = z.258
         z.2   = fst(decrypt(astat.248,
                             h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>)))
         z.3   = z.264
         z.4   = verify(astat.248,
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             <z.268, z.264>, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           astat2.249>),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = z.268
    
     55. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = astat.248
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         astat.248, '1'>),
                      z.256, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(decrypt(astat.248,
                             h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                               >)))
         z.3   = snd(x.476)
         z.4   = verify(astat.248,
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                     >), 
                                   astat.248, '1'>),
                                z.256, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     56. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = astat.248
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         astat.248, '1'>),
                      z.256, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = fst(decrypt(astat.248,
                             h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>)))
         z.3   = snd(x.476)
         z.4   = verify(astat.248,
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'
                                     >), 
                                   astat.248, '1'>),
                                z.256, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     57. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      x.473, x.474)
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = sct1.252
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                    '2'>),
                                 x.473, x.474), 
                            '1'>))
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(x.473)
         z.3   = snd(x.476)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                adec(sct1.252, ~ltkR.241), '2'>),
                             x.473, x.474),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), astat2.249
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     58. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      x.473, x.474)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                 '2'>),
                              x.473, x.474), 
                         '1'>),
                      z.256, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                         '2'>),
                                      x.473, x.474), 
                                 '1'>),
                              z.256, x.476)
                        >))
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(x.473)
         z.3   = snd(x.477)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                adec(sct1.252, ~ltkR.241), '2'>),
                             x.473, x.474),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = true
         z.6   = fst(x.477)
    
     59. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      x.473, h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>))
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      <z.268, z.264>, x.477)
         sct1  = sct1.252
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                    '2'>),
                                 x.473, h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                            '1'>))
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(x.473)
         z.3   = z.264
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             <z.268, z.264>, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), astat2.249
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = z.268
    
     60. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      x.473, h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                 '2'>),
                              x.473, h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                         '1'>),
                      z.256, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = fst(x.473)
         z.3   = snd(x.476)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                           adec(sct1.252, ~ltkR.241), '2'>),
                                        x.473,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                                   '1'>),
                                z.256, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     61. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), astat2.249
                        >))
         sct1  = sct1.252
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                    '2'>),
                                 <z.263, x.474>, x.475), 
                            '1'>))
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = z.263
         z.3   = snd(x.477)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                adec(sct1.252, ~ltkR.241), '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = true
         z.6   = fst(x.477)
    
     62. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                 '2'>),
                              <z.263, x.474>, x.475), 
                         '1'>),
                      z.256, x.477)
         ats   = ats.250
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = z.263
         z.3   = snd(decrypt(ats.250,
                             h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>)))
         z.4   = verify(aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                adec(sct1.252, ~ltkR.241), '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = verify(ats.250,
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                           adec(sct1.252, ~ltkR.241), '2'>),
                                        <z.263, x.474>, x.475), 
                                   '1'>),
                                z.256, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = fst(decrypt(ats.250,
                             h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>)))
    
     63. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                 '2'>),
                              <z.263, x.474>, x.475), 
                         '1'>),
                      z.256, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      <z.268, z.264>,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                         '2'>),
                                      <z.263, x.474>, x.475), 
                                 '1'>),
                              z.256, x.477)
                        >))
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = z.263
         z.3   = z.264
         z.4   = verify(aead(h(<h(<h('noise'), sct1.252, '1'>), 
                                adec(sct1.252, ~ltkR.241), '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>),
                        h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '2'
                          >))
         z.5   = true
         z.6   = z.268
    
     64. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      <z.263, x.474>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>))
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = sct1.252
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                    '2'>),
                                 <z.263, x.474>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                            '1'>))
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = z.263
         z.3   = snd(x.476)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                  >), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), astat2.249
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                             >), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     65. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), sct1.252, '1'>), 
                         adec(sct1.252, ~ltkR.241), '2'>),
                      <z.263, x.474>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                 '2'>),
                              <z.263, x.474>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                         '1'>),
                      z.256, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                           >), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.252, '1'>), adec(sct1.252, ~ltkR.241), 
                                         '2'>),
                                      <z.263, x.474>,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), sct1.252>)), 
                                 '1'>),
                              z.256, x.476)
                        >))
         sct1  = sct1.252
         z     = z.256
         z.1   = adec(sct1.252, ~ltkR.241)
         z.2   = z.263
         z.3   = snd(x.477)
         z.4   = true
         z.5   = true
         z.6   = fst(x.477)
    
     66. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      x.473, x.474)
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                    '2'>),
                                 x.473, x.474), 
                            '1'>))
         z.1   = z.258
         z.2   = fst(x.473)
         z.3   = snd(x.476)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>),
                             x.473, x.474),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           astat2.249>),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     67. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      x.473, x.474)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                 '2'>),
                              x.473, x.474), 
                         '1'>),
                      z.256, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                         '2'>),
                                      x.473, x.474), 
                                 '1'>),
                              z.256, x.476)
                        >))
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = fst(x.473)
         z.3   = snd(x.477)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>),
                             x.473, x.474),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = true
         z.6   = fst(x.477)
    
     68. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      x.473,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                        >))
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      <z.268, z.264>, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                    '2'>),
                                 x.473,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                                   >)), 
                            '1'>))
         z.1   = z.258
         z.2   = fst(x.473)
         z.3   = z.264
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             <z.268, z.264>, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           astat2.249>),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = z.268
    
     69. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      x.473,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                 '2'>),
                              x.473,
                              h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                                >)), 
                         '1'>),
                      z.256, x.475)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = fst(x.473)
         z.3   = snd(x.476)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                           '2'>),
                                        x.473,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), 
                                           aenc(z.258, pk(~ltkR.241))>)), 
                                   '1'>),
                                z.256, x.475)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     70. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                           >), 
                         astat2.249>))
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                    '2'>),
                                 <z.263, x.474>, x.475), 
                            '1'>))
         z.1   = z.258
         z.2   = z.263
         z.3   = snd(x.477)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = true
         z.6   = fst(x.477)
    
     71. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                 '2'>),
                              <z.263, x.474>, x.475), 
                         '1'>),
                      z.256, x.477)
         ats   = ats.250
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = z.263
         z.3   = snd(decrypt(ats.250,
                             h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>)))
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = verify(ats.250,
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                           '2'>),
                                        <z.263, x.474>, x.475), 
                                   '1'>),
                                z.256, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = fst(decrypt(ats.250,
                             h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>)))
    
     72. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      <z.263, x.474>, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                 '2'>),
                              <z.263, x.474>, x.475), 
                         '1'>),
                      z.256, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      <z.268, z.264>,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                         '2'>),
                                      <z.263, x.474>, x.475), 
                                 '1'>),
                              z.256, x.477)
                        >))
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = z.263
         z.3   = z.264
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>),
                             <z.263, x.474>, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                          >),
                        h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '2'>))
         z.5   = true
         z.6   = z.268
    
     73. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      <z.263, x.474>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                        >))
         astat2
               = astat2.249
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.476, x.477)
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = decrypt(astat2.249,
                         h(<
                            h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                    '2'>),
                                 <z.263, x.474>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                                   >)), 
                            '1'>))
         z.1   = z.258
         z.2   = z.263
         z.3   = snd(x.476)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                ~psk.242, '2'>),
                             x.476, x.477),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                             >), 
                           astat2.249>),
                        h(<
                           h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                           ~psk.242, '2'>))
         z.6   = fst(x.476)
    
     74. ~ltkR = ~ltkR.241
         ~psk  = ~psk.242
         astat = aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), 
                         z.258, '2'>),
                      <z.263, x.474>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                 '2'>),
                              <z.263, x.474>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                                >)), 
                         '1'>),
                      z.256, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                         ~psk.242, '2'>),
                      x.477,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.241)>), aenc(z.258, pk(~ltkR.241))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.258, pk(~ltkR.241)), '1'>), z.258, 
                                         '2'>),
                                      <z.263, x.474>,
                                      h(<h(<h('noise'), 'id', pk(~ltkR.241)>), 
                                         aenc(z.258, pk(~ltkR.241))>)), 
                                 '1'>),
                              z.256, x.476)
                        >))
         sct1  = aenc(z.258, pk(~ltkR.241))
         z     = z.256
         z.1   = z.258
         z.2   = z.263
         z.3   = snd(x.477)
         z.4   = true
         z.5   = true
         z.6   = fst(x.477)
    
     75. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = astat.249
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         astat.249, '1'>),
                      z.257, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = sct1.253
         z     = z.257
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = fst(decrypt(astat.249,
                             h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                               >)))
         z.3   = z.265
         z.4   = verify(astat.249,
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>),
                        h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                     >), 
                                   astat.249, '1'>),
                                z.257, x.476)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     76. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = astat.249
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         astat.249, '1'>),
                      z.257, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = z.257
         z.1   = z.259
         z.2   = fst(decrypt(astat.249,
                             h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>)))
         z.3   = z.265
         z.4   = verify(astat.249,
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                          >),
                        h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'
                                     >), 
                                   astat.249, '1'>),
                                z.257, x.476)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     77. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      x.474, x.475)
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = sct1.253
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                    '2'>),
                                 x.474, x.475), 
                            '1'>))
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = fst(x.474)
         z.3   = z.265
         z.4   = verify(aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                adec(sct1.253, ~ltkR.242), '2'>),
                             x.474, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>),
                        h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), astat2.250
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     78. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      x.474, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                 '2'>),
                              x.474, x.475), 
                         '1'>),
                      z.257, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = sct1.253
         z     = z.257
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = fst(x.474)
         z.3   = snd(x.478)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                adec(sct1.253, ~ltkR.242), '2'>),
                             x.474, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>),
                        h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                           adec(sct1.253, ~ltkR.242), '2'>),
                                        x.474, x.475), 
                                   '1'>),
                                z.257, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     79. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      x.474, h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                 '2'>),
                              x.474, h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>)), 
                         '1'>),
                      z.257, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = sct1.253
         z     = z.257
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = fst(x.474)
         z.3   = z.265
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                           adec(sct1.253, ~ltkR.242), '2'>),
                                        x.474,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>)), 
                                   '1'>),
                                z.257, x.476)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     80. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      <z.264, x.475>, x.476)
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = sct1.253
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                    '2'>),
                                 <z.264, x.475>, x.476), 
                            '1'>))
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = z.264
         z.3   = snd(x.478)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                adec(sct1.253, ~ltkR.242), '2'>),
                             <z.264, x.475>, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>),
                        h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), astat2.250
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     81. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      <z.264, x.475>, x.476)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                 '2'>),
                              <z.264, x.475>, x.476), 
                         '1'>),
                      z.257, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      x.479,
                      h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), 
                         aead(h(<
                                 h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                   >), 
                                 aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                         '2'>),
                                      <z.264, x.475>, x.476), 
                                 '1'>),
                              z.257, x.478)
                        >))
         sct1  = sct1.253
         z     = z.257
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = z.264
         z.3   = snd(x.479)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                adec(sct1.253, ~ltkR.242), '2'>),
                             <z.264, x.475>, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>),
                        h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '2'
                          >))
         z.5   = true
         z.6   = fst(x.479)
    
     82. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      <z.264, x.475>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>))
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = sct1.253
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                    '2'>),
                                 <z.264, x.475>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>)), 
                            '1'>))
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = z.264
         z.3   = z.265
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), astat2.250
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     83. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), sct1.253, '1'>), 
                         adec(sct1.253, ~ltkR.242), '2'>),
                      <z.264, x.475>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), 
                                 '2'>),
                              <z.264, x.475>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>)), 
                         '1'>),
                      z.257, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                           >), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = sct1.253
         z     = z.257
         z.1   = adec(sct1.253, ~ltkR.242)
         z.2   = z.264
         z.3   = snd(x.478)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                  >), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.253, '1'>), 
                                           adec(sct1.253, ~ltkR.242), '2'>),
                                        <z.264, x.475>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), sct1.253>)), 
                                   '1'>),
                                z.257, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.253, '1'>), adec(sct1.253, ~ltkR.242), '1'
                             >), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     84. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      x.474, x.475)
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                    '2'>),
                                 x.474, x.475), 
                            '1'>))
         z.1   = z.259
         z.2   = fst(x.474)
         z.3   = z.265
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>),
                             x.474, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                          >),
                        h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           astat2.250>),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     85. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      x.474, x.475)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                 '2'>),
                              x.474, x.475), 
                         '1'>),
                      z.257, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = z.257
         z.1   = z.259
         z.2   = fst(x.474)
         z.3   = snd(x.478)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>),
                             x.474, x.475),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                          >),
                        h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                           '2'>),
                                        x.474, x.475), 
                                   '1'>),
                                z.257, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     86. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      x.474,
                      h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                 '2'>),
                              x.474,
                              h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                                >)), 
                         '1'>),
                      z.257, x.476)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = z.257
         z.1   = z.259
         z.2   = fst(x.474)
         z.3   = z.265
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                           '2'>),
                                        x.474,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), 
                                           aenc(z.259, pk(~ltkR.242))>)), 
                                   '1'>),
                                z.257, x.476)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     87. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      <z.264, x.475>, x.476)
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                    '2'>),
                                 <z.264, x.475>, x.476), 
                            '1'>))
         z.1   = z.259
         z.2   = z.264
         z.3   = snd(x.478)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>),
                             <z.264, x.475>, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                          >),
                        h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           astat2.250>),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     88. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      <z.264, x.475>, x.476)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                 '2'>),
                              <z.264, x.475>, x.476), 
                         '1'>),
                      z.257, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      x.479,
                      h(<
                         h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                           >), 
                         aead(h(<
                                 h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                 aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                         '2'>),
                                      <z.264, x.475>, x.476), 
                                 '1'>),
                              z.257, x.478)
                        >))
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = z.257
         z.1   = z.259
         z.2   = z.264
         z.3   = snd(x.479)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>),
                             <z.264, x.475>, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                          >),
                        h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '2'>))
         z.5   = true
         z.6   = fst(x.479)
    
     89. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      <z.264, x.475>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                        >))
         astat2
               = astat2.250
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      <z.269, z.265>, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = decrypt(astat2.250,
                         h(<
                            h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                    '2'>),
                                 <z.264, x.475>,
                                 h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                                   >)), 
                            '1'>))
         z.1   = z.259
         z.2   = z.264
         z.3   = z.265
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             <z.269, z.265>, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           astat2.250>),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = z.269
    
     90. ~ltkR = ~ltkR.242
         ~psk  = ~psk.243
         astat = aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), 
                         z.259, '2'>),
                      <z.264, x.475>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                 '2'>),
                              <z.264, x.475>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                                >)), 
                         '1'>),
                      z.257, x.477)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                         ~psk.243, '2'>),
                      x.478, x.479)
         sct1  = aenc(z.259, pk(~ltkR.242))
         z     = z.257
         z.1   = z.259
         z.2   = z.264
         z.3   = snd(x.478)
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                                ~psk.243, '2'>),
                             x.478, x.479),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.242)>), aenc(z.259, pk(~ltkR.242))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, 
                                           '2'>),
                                        <z.264, x.475>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.242)>), 
                                           aenc(z.259, pk(~ltkR.242))>)), 
                                   '1'>),
                                z.257, x.477)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.259, pk(~ltkR.242)), '1'>), z.259, '1'>), 
                           ~psk.243, '2'>))
         z.6   = fst(x.478)
    
     91. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), sct1.254, '1'>), 
                         adec(sct1.254, ~ltkR.243), '2'>),
                      x.475, x.476)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), 
                                 '2'>),
                              x.475, x.476), 
                         '1'>),
                      z.258, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = sct1.254
         z     = z.258
         z.1   = adec(sct1.254, ~ltkR.243)
         z.2   = fst(x.475)
         z.3   = z.266
         z.4   = verify(aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                adec(sct1.254, ~ltkR.243), '2'>),
                             x.475, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>),
                        h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                  >), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                           adec(sct1.254, ~ltkR.243), '2'>),
                                        x.475, x.476), 
                                   '1'>),
                                z.258, x.478)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                             >), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     92. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), sct1.254, '1'>), 
                         adec(sct1.254, ~ltkR.243), '2'>),
                      <z.265, x.476>, x.477)
         astat2
               = astat2.251
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = sct1.254
         z     = decrypt(astat2.251,
                         h(<
                            h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                              >), 
                            aead(h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), 
                                    '2'>),
                                 <z.265, x.476>, x.477), 
                            '1'>))
         z.1   = adec(sct1.254, ~ltkR.243)
         z.2   = z.265
         z.3   = z.266
         z.4   = verify(aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                adec(sct1.254, ~ltkR.243), '2'>),
                             <z.265, x.476>, x.477),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>),
                        h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                  >), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>), astat2.251
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                             >), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     93. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), sct1.254, '1'>), 
                         adec(sct1.254, ~ltkR.243), '2'>),
                      <z.265, x.476>, x.477)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), 
                                 '2'>),
                              <z.265, x.476>, x.477), 
                         '1'>),
                      z.258, x.479)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         ~psk.244, '2'>),
                      x.480, x.481)
         sct1  = sct1.254
         z     = z.258
         z.1   = adec(sct1.254, ~ltkR.243)
         z.2   = z.265
         z.3   = snd(x.480)
         z.4   = verify(aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                adec(sct1.254, ~ltkR.243), '2'>),
                             <z.265, x.476>, x.477),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>),
                        h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                  >), 
                                ~psk.244, '2'>),
                             x.480, x.481),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                           adec(sct1.254, ~ltkR.243), '2'>),
                                        <z.265, x.476>, x.477), 
                                   '1'>),
                                z.258, x.479)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                             >), 
                           ~psk.244, '2'>))
         z.6   = fst(x.480)
    
     94. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), sct1.254, '1'>), 
                         adec(sct1.254, ~ltkR.243), '2'>),
                      <z.265, x.476>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), 
                                 '2'>),
                              <z.265, x.476>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>)), 
                         '1'>),
                      z.258, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                           >), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = sct1.254
         z     = z.258
         z.1   = adec(sct1.254, ~ltkR.243)
         z.2   = z.265
         z.3   = z.266
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                  >), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.254, '1'>), 
                                           adec(sct1.254, ~ltkR.243), '2'>),
                                        <z.265, x.476>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), sct1.254>)), 
                                   '1'>),
                                z.258, x.478)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.254, '1'>), adec(sct1.254, ~ltkR.243), '1'
                             >), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     95. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), 
                         z.260, '2'>),
                      x.475, x.476)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                 '2'>),
                              x.475, x.476), 
                         '1'>),
                      z.258, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = aenc(z.260, pk(~ltkR.243))
         z     = z.258
         z.1   = z.260
         z.2   = fst(x.475)
         z.3   = z.266
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>),
                             x.475, x.476),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                          >),
                        h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                           '2'>),
                                        x.475, x.476), 
                                   '1'>),
                                z.258, x.478)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     96. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), 
                         z.260, '2'>),
                      <z.265, x.476>, x.477)
         astat2
               = astat2.251
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = aenc(z.260, pk(~ltkR.243))
         z     = decrypt(astat2.251,
                         h(<
                            h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                            aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                    '2'>),
                                 <z.265, x.476>, x.477), 
                            '1'>))
         z.1   = z.260
         z.2   = z.265
         z.3   = z.266
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>),
                             <z.265, x.476>, x.477),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                          >),
                        h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                             >), 
                           astat2.251>),
                        h(<
                           h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     97. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), 
                         z.260, '2'>),
                      <z.265, x.476>, x.477)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                 '2'>),
                              <z.265, x.476>, x.477), 
                         '1'>),
                      z.258, x.479)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         ~psk.244, '2'>),
                      x.480, x.481)
         sct1  = aenc(z.260, pk(~ltkR.243))
         z     = z.258
         z.1   = z.260
         z.2   = z.265
         z.3   = snd(x.480)
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>),
                             <z.265, x.476>, x.477),
                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                          >),
                        h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                                ~psk.244, '2'>),
                             x.480, x.481),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                           '2'>),
                                        <z.265, x.476>, x.477), 
                                   '1'>),
                                z.258, x.479)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                           ~psk.244, '2'>))
         z.6   = fst(x.480)
    
     98. ~ltkR = ~ltkR.243
         ~psk  = ~psk.244
         astat = aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), 
                         z.260, '2'>),
                      <z.265, x.476>,
                      h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                        >))
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                 '2'>),
                              <z.265, x.476>,
                              h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                                >)), 
                         '1'>),
                      z.258, x.478)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                         ~psk.244, '2'>),
                      <z.270, z.266>, x.481)
         sct1  = aenc(z.260, pk(~ltkR.243))
         z     = z.258
         z.1   = z.260
         z.2   = z.265
         z.3   = z.266
         z.4   = true
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                                ~psk.244, '2'>),
                             <z.270, z.266>, x.481),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.243)>), aenc(z.260, pk(~ltkR.243))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, 
                                           '2'>),
                                        <z.265, x.476>,
                                        h(<h(<h('noise'), 'id', pk(~ltkR.243)>), 
                                           aenc(z.260, pk(~ltkR.243))>)), 
                                   '1'>),
                                z.258, x.478)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.260, pk(~ltkR.243)), '1'>), z.260, '1'>), 
                           ~psk.244, '2'>))
         z.6   = z.270
    
     99. ~ltkR = ~ltkR.244
         ~psk  = ~psk.245
         astat = aead(h(<h(<h('noise'), sct1.255, '1'>), 
                         adec(sct1.255, ~ltkR.244), '2'>),
                      <z.266, x.477>, x.478)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '1'
                           >), 
                         aead(h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), 
                                 '2'>),
                              <z.266, x.477>, x.478), 
                         '1'>),
                      z.259, x.480)
         ats   = aead(h(<
                         h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '1'
                           >), 
                         ~psk.245, '2'>),
                      <z.271, z.267>, x.483)
         sct1  = sct1.255
         z     = z.259
         z.1   = adec(sct1.255, ~ltkR.244)
         z.2   = z.266
         z.3   = z.267
         z.4   = verify(aead(h(<h(<h('noise'), sct1.255, '1'>), 
                                adec(sct1.255, ~ltkR.244), '2'>),
                             <z.266, x.477>, x.478),
                        h(<h(<h('noise'), 'id', pk(~ltkR.244)>), sct1.255>),
                        h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '2'
                          >))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '1'
                                  >), 
                                ~psk.245, '2'>),
                             <z.271, z.267>, x.483),
                        h(<h(<h(<h('noise'), 'id', pk(~ltkR.244)>), sct1.255>), 
                           aead(h(<
                                   h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '1'
                                     >), 
                                   aead(h(<h(<h('noise'), sct1.255, '1'>), 
                                           adec(sct1.255, ~ltkR.244), '2'>),
                                        <z.266, x.477>, x.478), 
                                   '1'>),
                                z.259, x.480)
                          >),
                        h(<
                           h(<h(<h('noise'), sct1.255, '1'>), adec(sct1.255, ~ltkR.244), '1'
                             >), 
                           ~psk.245, '2'>))
         z.6   = z.271
    
    100. ~ltkR = ~ltkR.244
         ~psk  = ~psk.245
         astat = aead(h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), 
                         z.261, '2'>),
                      <z.266, x.477>, x.478)
         astat2
               = aead(h(<
                         h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '1'>), 
                         aead(h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, 
                                 '2'>),
                              <z.266, x.477>, x.478), 
                         '1'>),
                      z.259, x.480)
         ats   = aead(h(<
                         h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '1'>), 
                         ~psk.245, '2'>),
                      <z.271, z.267>, x.483)
         sct1  = aenc(z.261, pk(~ltkR.244))
         z     = z.259
         z.1   = z.261
         z.2   = z.266
         z.3   = z.267
         z.4   = verify(aead(h(<
                                h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '2'>),
                             <z.266, x.477>, x.478),
                        h(<h(<h('noise'), 'id', pk(~ltkR.244)>), aenc(z.261, pk(~ltkR.244))
                          >),
                        h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '2'>))
         z.5   = verify(aead(h(<
                                h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '1'>), 
                                ~psk.245, '2'>),
                             <z.271, z.267>, x.483),
                        h(<
                           h(<h(<h('noise'), 'id', pk(~ltkR.244)>), aenc(z.261, pk(~ltkR.244))
                             >), 
                           aead(h(<
                                   h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '1'
                                     >), 
                                   aead(h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, 
                                           '2'>),
                                        <z.266, x.477>, x.478), 
                                   '1'>),
                                z.259, x.480)
                          >),
                        h(<
                           h(<h(<h('noise'), aenc(z.261, pk(~ltkR.244)), '1'>), z.261, '1'>), 
                           ~psk.245, '2'>))
         z.6   = z.271
    // loop breaker: [0]
  */

rule (modulo E) Handshake_Complete:
   [
   L_State( ~id, <'init', sidI, ekI, ci2, hi2, kb> ),
   F_SolveInit( ~id, ~psk, <'init', sidI, ekI, ci2, hi2, kb> ),
   !F_StateInvariants( ~id, ~psk, ~ltkI, pkR, ~tpk ),
   In( <'2', sidI, sidR, sct, ect, aempt, $mac1, $mac2> )
   ]
  --[
  Eq( decrypt(aempt,
              h(<
                 h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                    '1'>), 
                 ~psk, '3'>)),
      'e'
  ),
  Eq( verify(aempt,
             h(<h(<hi2, sct>), 
                h(<
                   h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                      '1'>), 
                   ~psk, '2'>)
               >),
             h(<
                h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                   '1'>), 
                ~psk, '3'>)),
      true
  ),
  IKeys( <pk(~ltkI), pkR, pk(ekI), ~psk, 
          h(<
             h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                '1'>), 
             ~psk, '1'>), 
          kb, adec(sct, ~ltkI), adec(ect, ekI)>
  )
  ]->
   [
   L_State( ~id,
            <'transport', sidI, 
             h(<
                h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                   '1'>), 
                ~psk, '1'>)
            >
   ),
   Out( <'4', sidR, 
         aead(h(<
                 h(<h(<h(<ci2, sct, '1'>), adec(ect, ekI), '1'>), adec(sct, ~ltkI), 
                    '1'>), 
                 ~psk, '1'>),
              'message', '0')
        >
   )
   ]

  /*
  rule (modulo AC) Handshake_Complete:
     [
     L_State( ~id, <'init', sidI, ekI, ci2, hi2, kb> ),
     F_SolveInit( ~id, ~psk, <'init', sidI, ekI, ci2, hi2, kb> ),
     !F_StateInvariants( ~id, ~psk, ~ltkI, pkR, ~tpk ),
     In( <'2', sidI, sidR, sct, ect, aempt, $mac1, $mac2> )
     ]
    --[
    Eq( z.2, 'e' ), Eq( z.3, true ),
    IKeys( <pk(~ltkI), pkR, pk(ekI), ~psk, 
            h(<h(<h(<h(<ci2, sct, '1'>), z, '1'>), z.1, '1'>), ~psk, '1'>), 
            kb, z.1, z>
    )
    ]->
     [
     L_State( ~id,
              <'transport', sidI, 
               h(<h(<h(<h(<ci2, sct, '1'>), z, '1'>), z.1, '1'>), ~psk, '1'>)>
     ),
     Out( <'4', sidR, 
           aead(h(<h(<h(<h(<ci2, sct, '1'>), z, '1'>), z.1, '1'>), ~psk, '1'
                  >),
                'message', '0')
          >
     )
     ]
    variants (modulo AC)
     1. ~ltkI = ~ltkI.40
        ~psk  = ~psk.41
        aempt = aempt.43
        ci2   = ci2.44
        ect   = ect.45
        ekI   = ekI.46
        hi2   = hi2.47
        sct   = sct.50
        z     = adec(ect.45, ekI.46)
        z.1   = adec(sct.50, ~ltkI.40)
        z.2   = decrypt(aempt.43,
                        h(<
                           h(<h(<h(<ci2.44, sct.50, '1'>), adec(ect.45, ekI.46), '1'>), 
                              adec(sct.50, ~ltkI.40), '1'>), 
                           ~psk.41, '3'>))
        z.3   = verify(aempt.43,
                       h(<h(<hi2.47, sct.50>), 
                          h(<
                             h(<h(<h(<ci2.44, sct.50, '1'>), adec(ect.45, ekI.46), '1'>), 
                                adec(sct.50, ~ltkI.40), '1'>), 
                             ~psk.41, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.44, sct.50, '1'>), adec(ect.45, ekI.46), '1'>), 
                             adec(sct.50, ~ltkI.40), '1'>), 
                          ~psk.41, '3'>))
    
     2. ~ltkI = ~ltkI.47
        ~psk  = ~psk.48
        aempt = aempt.50
        ci2   = ci2.51
        ect   = aenc(z.64, pk(ekI.53))
        ekI   = ekI.53
        hi2   = hi2.54
        sct   = sct.57
        z     = z.64
        z.1   = adec(sct.57, ~ltkI.47)
        z.2   = decrypt(aempt.50,
                        h(<
                           h(<h(<h(<ci2.51, sct.57, '1'>), z.64, '1'>), 
                              adec(sct.57, ~ltkI.47), '1'>), 
                           ~psk.48, '3'>))
        z.3   = verify(aempt.50,
                       h(<h(<hi2.54, sct.57>), 
                          h(<
                             h(<h(<h(<ci2.51, sct.57, '1'>), z.64, '1'>), 
                                adec(sct.57, ~ltkI.47), '1'>), 
                             ~psk.48, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.51, sct.57, '1'>), z.64, '1'>), 
                             adec(sct.57, ~ltkI.47), '1'>), 
                          ~psk.48, '3'>))
    
     3. ~ltkI = ~ltkI.48
        ~psk  = ~psk.49
        aempt = aempt.51
        ci2   = ci2.52
        ect   = ect.53
        ekI   = ekI.54
        hi2   = hi2.55
        sct   = aenc(z.66, pk(~ltkI.48))
        z     = adec(ect.53, ekI.54)
        z.1   = z.66
        z.2   = decrypt(aempt.51,
                        h(<
                           h(<
                              h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), 
                                 adec(ect.53, ekI.54), '1'>), 
                              z.66, '1'>), 
                           ~psk.49, '3'>))
        z.3   = verify(aempt.51,
                       h(<h(<hi2.55, aenc(z.66, pk(~ltkI.48))>), 
                          h(<
                             h(<
                                h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), 
                                   adec(ect.53, ekI.54), '1'>), 
                                z.66, '1'>), 
                             ~psk.49, '2'>)
                         >),
                       h(<
                          h(<
                             h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), 
                                adec(ect.53, ekI.54), '1'>), 
                             z.66, '1'>), 
                          ~psk.49, '3'>))
    
     4. ~ltkI = ~ltkI.48
        ~psk  = ~psk.49
        aempt = aempt.51
        ci2   = ci2.52
        ect   = aenc(z.65, pk(ekI.54))
        ekI   = ekI.54
        hi2   = hi2.55
        sct   = aenc(z.66, pk(~ltkI.48))
        z     = z.65
        z.1   = z.66
        z.2   = decrypt(aempt.51,
                        h(<
                           h(<h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), z.65, '1'>), 
                              z.66, '1'>), 
                           ~psk.49, '3'>))
        z.3   = verify(aempt.51,
                       h(<h(<hi2.55, aenc(z.66, pk(~ltkI.48))>), 
                          h(<
                             h(<h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), z.65, '1'>), 
                                z.66, '1'>), 
                             ~psk.49, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.52, aenc(z.66, pk(~ltkI.48)), '1'>), z.65, '1'>), 
                             z.66, '1'>), 
                          ~psk.49, '3'>))
    
     5. ~ltkI = ~ltkI.52
        ~psk  = ~psk.53
        aempt = aead(h(<
                        h(<h(<h(<ci2.56, sct.62, '1'>), z.69, '1'>), 
                           adec(sct.62, ~ltkI.52), '1'>), 
                        ~psk.53, '3'>),
                     z.74,
                     h(<h(<hi2.59, sct.62>), 
                        h(<
                           h(<h(<h(<ci2.56, sct.62, '1'>), z.69, '1'>), 
                              adec(sct.62, ~ltkI.52), '1'>), 
                           ~psk.53, '2'>)
                       >))
        ci2   = ci2.56
        ect   = aenc(z.69, pk(ekI.58))
        ekI   = ekI.58
        hi2   = hi2.59
        sct   = sct.62
        z     = z.69
        z.1   = adec(sct.62, ~ltkI.52)
        z.2   = z.74
        z.3   = true
    
     6. ~ltkI = ~ltkI.52
        ~psk  = ~psk.53
        aempt = aead(h(<
                        h(<h(<h(<ci2.56, sct.62, '1'>), adec(ect.57, ekI.58), '1'>), 
                           adec(sct.62, ~ltkI.52), '1'>), 
                        ~psk.53, '3'>),
                     z.74,
                     h(<h(<hi2.59, sct.62>), 
                        h(<
                           h(<h(<h(<ci2.56, sct.62, '1'>), adec(ect.57, ekI.58), '1'>), 
                              adec(sct.62, ~ltkI.52), '1'>), 
                           ~psk.53, '2'>)
                       >))
        ci2   = ci2.56
        ect   = ect.57
        ekI   = ekI.58
        hi2   = hi2.59
        sct   = sct.62
        z     = adec(ect.57, ekI.58)
        z.1   = adec(sct.62, ~ltkI.52)
        z.2   = z.74
        z.3   = true
    
     7. ~ltkI = ~ltkI.52
        ~psk  = ~psk.53
        aempt = aead(h(<
                        h(<h(<h(<ci2.56, aenc(z.70, pk(~ltkI.52)), '1'>), z.69, '1'>), 
                           z.70, '1'>), 
                        ~psk.53, '3'>),
                     z.74,
                     h(<h(<hi2.59, aenc(z.70, pk(~ltkI.52))>), 
                        h(<
                           h(<h(<h(<ci2.56, aenc(z.70, pk(~ltkI.52)), '1'>), z.69, '1'>), 
                              z.70, '1'>), 
                           ~psk.53, '2'>)
                       >))
        ci2   = ci2.56
        ect   = aenc(z.69, pk(ekI.58))
        ekI   = ekI.58
        hi2   = hi2.59
        sct   = aenc(z.70, pk(~ltkI.52))
        z     = z.69
        z.1   = z.70
        z.2   = z.74
        z.3   = true
    
     8. ~ltkI = ~ltkI.52
        ~psk  = ~psk.53
        aempt = aead(h(<
                        h(<
                           h(<h(<ci2.56, aenc(z.70, pk(~ltkI.52)), '1'>), 
                              adec(ect.57, ekI.58), '1'>), 
                           z.70, '1'>), 
                        ~psk.53, '3'>),
                     z.74,
                     h(<h(<hi2.59, aenc(z.70, pk(~ltkI.52))>), 
                        h(<
                           h(<
                              h(<h(<ci2.56, aenc(z.70, pk(~ltkI.52)), '1'>), 
                                 adec(ect.57, ekI.58), '1'>), 
                              z.70, '1'>), 
                           ~psk.53, '2'>)
                       >))
        ci2   = ci2.56
        ect   = ect.57
        ekI   = ekI.58
        hi2   = hi2.59
        sct   = aenc(z.70, pk(~ltkI.52))
        z     = adec(ect.57, ekI.58)
        z.1   = z.70
        z.2   = z.74
        z.3   = true
    
     9. ~ltkI = ~ltkI.212
        ~psk  = ~psk.213
        aempt = aead(h(<
                        h(<h(<h(<ci2.216, sct.222, '1'>), z.229, '1'>), 
                           adec(sct.222, ~ltkI.212), '1'>), 
                        ~psk.213, '3'>),
                     z.234, x.419)
        ci2   = ci2.216
        ect   = aenc(z.229, pk(ekI.218))
        ekI   = ekI.218
        hi2   = hi2.219
        sct   = sct.222
        z     = z.229
        z.1   = adec(sct.222, ~ltkI.212)
        z.2   = z.234
        z.3   = verify(aead(h(<
                               h(<h(<h(<ci2.216, sct.222, '1'>), z.229, '1'>), 
                                  adec(sct.222, ~ltkI.212), '1'>), 
                               ~psk.213, '3'>),
                            z.234, x.419),
                       h(<h(<hi2.219, sct.222>), 
                          h(<
                             h(<h(<h(<ci2.216, sct.222, '1'>), z.229, '1'>), 
                                adec(sct.222, ~ltkI.212), '1'>), 
                             ~psk.213, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.216, sct.222, '1'>), z.229, '1'>), 
                             adec(sct.222, ~ltkI.212), '1'>), 
                          ~psk.213, '3'>))
    
    10. ~ltkI = ~ltkI.212
        ~psk  = ~psk.213
        aempt = aead(h(<
                        h(<h(<h(<ci2.216, aenc(z.230, pk(~ltkI.212)), '1'>), z.229, '1'>), 
                           z.230, '1'>), 
                        ~psk.213, '3'>),
                     z.234, x.419)
        ci2   = ci2.216
        ect   = aenc(z.229, pk(ekI.218))
        ekI   = ekI.218
        hi2   = hi2.219
        sct   = aenc(z.230, pk(~ltkI.212))
        z     = z.229
        z.1   = z.230
        z.2   = z.234
        z.3   = verify(aead(h(<
                               h(<h(<h(<ci2.216, aenc(z.230, pk(~ltkI.212)), '1'>), z.229, '1'>), 
                                  z.230, '1'>), 
                               ~psk.213, '3'>),
                            z.234, x.419),
                       h(<h(<hi2.219, aenc(z.230, pk(~ltkI.212))>), 
                          h(<
                             h(<h(<h(<ci2.216, aenc(z.230, pk(~ltkI.212)), '1'>), z.229, '1'>), 
                                z.230, '1'>), 
                             ~psk.213, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.216, aenc(z.230, pk(~ltkI.212)), '1'>), z.229, '1'>), 
                             z.230, '1'>), 
                          ~psk.213, '3'>))
    
    11. ~ltkI = ~ltkI.213
        ~psk  = ~psk.214
        aempt = aead(h(<
                        h(<h(<h(<ci2.217, sct.223, '1'>), adec(ect.218, ekI.219), '1'>), 
                           adec(sct.223, ~ltkI.213), '1'>), 
                        ~psk.214, '3'>),
                     z.235, x.421)
        ci2   = ci2.217
        ect   = ect.218
        ekI   = ekI.219
        hi2   = hi2.220
        sct   = sct.223
        z     = adec(ect.218, ekI.219)
        z.1   = adec(sct.223, ~ltkI.213)
        z.2   = z.235
        z.3   = verify(aead(h(<
                               h(<h(<h(<ci2.217, sct.223, '1'>), adec(ect.218, ekI.219), '1'>), 
                                  adec(sct.223, ~ltkI.213), '1'>), 
                               ~psk.214, '3'>),
                            z.235, x.421),
                       h(<h(<hi2.220, sct.223>), 
                          h(<
                             h(<h(<h(<ci2.217, sct.223, '1'>), adec(ect.218, ekI.219), '1'>), 
                                adec(sct.223, ~ltkI.213), '1'>), 
                             ~psk.214, '2'>)
                         >),
                       h(<
                          h(<h(<h(<ci2.217, sct.223, '1'>), adec(ect.218, ekI.219), '1'>), 
                             adec(sct.223, ~ltkI.213), '1'>), 
                          ~psk.214, '3'>))
    
    12. ~ltkI = ~ltkI.213
        ~psk  = ~psk.214
        aempt = aead(h(<
                        h(<
                           h(<h(<ci2.217, aenc(z.231, pk(~ltkI.213)), '1'>), 
                              adec(ect.218, ekI.219), '1'>), 
                           z.231, '1'>), 
                        ~psk.214, '3'>),
                     z.235, x.421)
        ci2   = ci2.217
        ect   = ect.218
        ekI   = ekI.219
        hi2   = hi2.220
        sct   = aenc(z.231, pk(~ltkI.213))
        z     = adec(ect.218, ekI.219)
        z.1   = z.231
        z.2   = z.235
        z.3   = verify(aead(h(<
                               h(<
                                  h(<h(<ci2.217, aenc(z.231, pk(~ltkI.213)), '1'>), 
                                     adec(ect.218, ekI.219), '1'>), 
                                  z.231, '1'>), 
                               ~psk.214, '3'>),
                            z.235, x.421),
                       h(<h(<hi2.220, aenc(z.231, pk(~ltkI.213))>), 
                          h(<
                             h(<
                                h(<h(<ci2.217, aenc(z.231, pk(~ltkI.213)), '1'>), 
                                   adec(ect.218, ekI.219), '1'>), 
                                z.231, '1'>), 
                             ~psk.214, '2'>)
                         >),
                       h(<
                          h(<
                             h(<h(<ci2.217, aenc(z.231, pk(~ltkI.213)), '1'>), 
                                adec(ect.218, ekI.219), '1'>), 
                             z.231, '1'>), 
                          ~psk.214, '3'>))
  */

rule (modulo E) R_ConfirmedTransportMessage:
   [
   L_State( ~id,
            <'transport_unconfirmed', ~sidR, pekI, cr6, kb, ka, k>
   ),
   F_SolveResp( ~id, ~psk,
                <'transport_unconfirmed', ~sidR, pekI, cr6, kb, ka, k>
   ),
   !F_StateInvariants( ~id, ~psk, ~ltkR, pkI, ~tpk ),
   In( <'4', ~sidR, data> )
   ]
  --[
  Eq( verify(data, '0', cr6), true ),
  RConfirm( <pkI, pk(~ltkR), pekI, ~psk, cr6, kb, ka, k> )
  ]->
   [ L_State( ~id, <'transport', ~sidR, cr6> ) ]

  /*
  rule (modulo AC) R_ConfirmedTransportMessage:
     [
     L_State( ~id,
              <'transport_unconfirmed', ~sidR, pekI, cr6, kb, ka, k>
     ),
     F_SolveResp( ~id, ~psk,
                  <'transport_unconfirmed', ~sidR, pekI, cr6, kb, ka, k>
     ),
     !F_StateInvariants( ~id, ~psk, ~ltkR, pkI, ~tpk ),
     In( <'4', ~sidR, data> )
     ]
    --[
    Eq( z, true ),
    RConfirm( <pkI, pk(~ltkR), pekI, ~psk, cr6, kb, ka, k> )
    ]->
     [ L_State( ~id, <'transport', ~sidR, cr6> ) ]
    variants (modulo AC)
    1. cr6   = cr6.19
       data  = data.20
       z     = verify(data.20, '0', cr6.19)
    
    2. cr6   = cr6.41
       data  = aead(cr6.41, x.75, '0')
       z     = true
  */

lemma session_create:
  exists-trace
  "∃ pki pkr peki psk ck kb ka k #i #j.
    ((IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
     (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)) ∧
    (#i < #j)"
/*
guarded formula characterizing all satisfying traces:
"∃ pki pkr peki psk ck kb ka k #i #j.
  (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)
 ∧
  #i < #j"
*/
by sorry

lemma session_key_collision [reuse]:
  all-traces
  "∀ pki1 pki2 pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb1 kb2 ka1 ka2 k1
     k2 r1 r2 r3 tpk1 tpk2 #i #j #i1.
    ((((((IKeys( <pki1, pkr1, peki1, psk1, ck, kb1, ka1, k1> ) @ #i) ∧
         (RKeys( <pki2, pkr2, peki2, psk2, ck, kb2, ka2, k2> ) @ #j)) ∧
        (PRFGen( tpk1, r3, kb1 ) @ #i1)) ∧
       (#i1 < #i)) ∧
      (PRFGen( tpk2, r1, ka2 ) @ #j)) ∧
     (PRFGen( tpk2, r2, k2 ) @ #j)) ⇒
    (((((((psk1 = psk2) ∧ (kb1 = kb2)) ∧ (ka1 = ka2)) ∧ (k1 = k2)) ∧
       (peki1 = peki2)) ∧
      (pki1 = pki2)) ∧
     ((pkr1 = pkr2) ∨
      ((((∃ #j1. Reveal_AK( pkr1 ) @ #j1) ∨
         ((∃ #j1. Reveal_rnd( r3 ) @ #j1) ∧
          (∃ #j1. Reveal_prfk( tpk1 ) @ #j1))) ∧
        ((∃ #j1. Reveal_AK( pki1 ) @ #j1) ∨
         ((∃ #j1. Reveal_rnd( r1 ) @ #j1) ∧
          (∃ #j1. Reveal_prfk( tpk2 ) @ #j1)))) ∧
       ((∃ #j1. Reveal_EphK( peki1 ) @ #j1) ∨
        ((∃ #j1. Reveal_rnd( r2 ) @ #j1) ∧
         (∃ #j1. Reveal_prfk( tpk2 ) @ #j1))))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki1 pki2 pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb1 kb2 ka1 ka2 k1
   k2 r1 r2 r3 tpk1 tpk2 #i #j #i1.
  (IKeys( <pki1, pkr1, peki1, psk1, ck, kb1, ka1, k1> ) @ #i) ∧
  (RKeys( <pki2, pkr2, peki2, psk2, ck, kb2, ka2, k2> ) @ #j) ∧
  (PRFGen( tpk1, r3, kb1 ) @ #i1) ∧
  (PRFGen( tpk2, r1, ka2 ) @ #j) ∧
  (PRFGen( tpk2, r2, k2 ) @ #j)
 ∧
  (#i1 < #i) ∧
  (((¬(psk1 = psk2)) ∨
    (¬(kb1 = kb2)) ∨
    (¬(ka1 = ka2)) ∨
    (¬(k1 = k2)) ∨
    (¬(peki1 = peki2)) ∨
    (¬(pki1 = pki2)) ∨
    ((¬(pkr1 = pkr2)) ∧
     ((((∀ #j1. (Reveal_AK( pkr1 ) @ #j1) ⇒ ⊥) ∧
        (((∀ #j1. (Reveal_rnd( r3 ) @ #j1) ⇒ ⊥) ∨
          (∀ #j1. (Reveal_prfk( tpk1 ) @ #j1) ⇒ ⊥)))) ∨
       ((∀ #j1. (Reveal_AK( pki1 ) @ #j1) ⇒ ⊥) ∧
        (((∀ #j1. (Reveal_rnd( r1 ) @ #j1) ⇒ ⊥) ∨
          (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))) ∨
       ((∀ #j1. (Reveal_EphK( peki1 ) @ #j1) ⇒ ⊥) ∧
        (((∀ #j1. (Reveal_rnd( r2 ) @ #j1) ⇒ ⊥) ∨
          (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))))))))"
*/
by sorry

lemma session_uniq [reuse]:
  all-traces
  "(∀ pki pkr peki psk ck kb ka k #i.
     (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ⇒
     (¬(∃ peki2 #j1.
         (IKeys( <pki, pkr, peki2, psk, ck, kb, ka, k> ) @ #j1) ∧
         (¬(#j1 = #i))))) ∧
   (∀ pki pkr peki psk ck kb ka k #i.
     (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ⇒
     (¬(∃ peki2 psk2 #j1.
         (RConfirm( <pki, pkr, peki2, psk2, ck, kb, ka, k> ) @ #j1) ∧
         (¬(#j1 = #i)))))"
/*
guarded formula characterizing all counter-examples:
"((∃ pki pkr peki psk ck kb ka k #i.
    (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i)
   ∧
    ∃ peki2 #j1.
     (IKeys( <pki, pkr, peki2, psk, ck, kb, ka, k> ) @ #j1)
    ∧
     ¬(#j1 = #i)) ∨
  (∃ pki pkr peki psk ck kb ka k #i.
    (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i)
   ∧
    ∃ peki2 psk2 #j1.
     (RConfirm( <pki, pkr, peki2, psk2, ck, kb, ka, k> ) @ #j1)
    ∧
     ¬(#j1 = #i)))"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∃ pki pkr peki psk ck kb ka k #i.
           (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i)
          ∧
           ∃ peki2 #j1.
            (IKeys( <pki, pkr, peki2, psk, ck, kb, ka, k> ) @ #j1)
           ∧
            ¬(#j1 = #i))  ∥
         (∃ pki pkr peki psk ck kb ka k #i.
           (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i)
          ∧
           ∃ peki2 psk2 #j1.
            (RConfirm( <pki, pkr, peki2, psk2, ck, kb, ka, k> ) @ #j1)
           ∧
            ¬(#j1 = #i)) )
    case case_1
    solve( F_SolveInit( ~id, ~psk, <'init', sidI, ekI, ci2, hi2, kb>
           ) ▶₁ #i )
      case Handshake_Init
      solve( !F_StateInvariants( ~id, ~psk, ~ltkI.1, pkr, ~tpk.1
             ) ▶₂ #i )
        case AddPublicKey
        solve( F_SolveInit( ~id.1, ~psk,
                            <'init', sidI.1, ekI.1, 
                             h(<
                                h(<h(<h('noise'), aenc(prf(~tpk, ~r3), pk(~ltkB)), '1'>), 
                                   prf(~tpk, ~r3), '1'>), 
                                ~psk, '1'>), 
                             hi2, prf(~tpk, ~r3)>
               ) ▶₁ #j1 )
          case Handshake_Init
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case case_2
    solve( F_SolveResp( ~id, ~psk,
                        <'transport_unconfirmed', ~sidR, peki, ck, kb, ka, k>
           ) ▶₁ #i )
      case Handshake_Resp
      solve( !F_StateInvariants( ~id, ~psk, ~ltkR, pki, ~tpk.1 ) ▶₂ #i )
        case AddPublicKey
        solve( F_SolveResp( ~id.1, ~psk.1,
                            <'transport_unconfirmed', ~sidR.1, peki2, 
                             h(<
                                h(<
                                   h(<
                                      h(<h(<h(<h(<h('noise'), sct1, '1'>), kb, '1'>), ~psk, '1'>), 
                                         aenc(prf(~tpk, ~r1), pk(~ltkB)), '1'>), 
                                      prf(~tpk, ~r2), '1'>), 
                                   prf(~tpk, ~r1), '1'>), 
                                ~psk, '1'>), 
                             kb, prf(~tpk, ~r1), prf(~tpk, ~r2)>
               ) ▶₁ #j1 )
          case Handshake_Resp
          by contradiction /* from formulas */
        qed
      qed
    qed
  qed
qed

lemma KCI_on_initiator_resistance [reuse]:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk r #i #i1.
    ((((IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
       (PRFGen( tpk, r, kb ) @ #i1)) ∧
      (#i1 < #i)) ∧
     (¬(∃ #j.
         (#j < #i) ∧
         (RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)))) ⇒
    ((∃ #j. (Reveal_PSK( psk ) @ #j) ∧ (#j < #i)) ∧
     ((∃ #j. (Reveal_AK( pkr ) @ #j) ∧ (#j < #i)) ∨
      ((∃ #j. Reveal_rnd( r ) @ #j) ∧ (∃ #j. Reveal_prfk( tpk ) @ #j))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk r #i #i1.
  (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk, r, kb ) @ #i1)
 ∧
  (#i1 < #i) ∧
  (∀ #j.
    (RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)
   ⇒
    ¬(#j < #i)) ∧
  (((∀ #j. (Reveal_PSK( psk ) @ #j) ⇒ ¬(#j < #i)) ∨
    ((∀ #j. (Reveal_AK( pkr ) @ #j) ⇒ ¬(#j < #i)) ∧
     (((∀ #j. (Reveal_rnd( r ) @ #j) ⇒ ⊥) ∨
       (∀ #j. (Reveal_prfk( tpk ) @ #j) ⇒ ⊥))))))"
*/
by sorry

lemma KCI_on_responder_resistance [reuse]:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk r #i.
    (((RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
      (PRFGen( tpk, r, ka ) @ #i)) ∧
     (¬(∃ #j.
         (#j < #i) ∧
         (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)))) ⇒
    ((∃ #j. (Reveal_PSK( psk ) @ #j) ∧ (#j < #i)) ∧
     ((∃ #j. (Reveal_AK( pki ) @ #j) ∧ (#j < #i)) ∨
      ((∃ #j. Reveal_rnd( r ) @ #j) ∧ (∃ #j. Reveal_prfk( tpk ) @ #j))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk r #i.
  (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk, r, ka ) @ #i)
 ∧
  (∀ #j.
    (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #j)
   ⇒
    ¬(#j < #i)) ∧
  (((∀ #j. (Reveal_PSK( psk ) @ #j) ⇒ ¬(#j < #i)) ∨
    ((∀ #j. (Reveal_AK( pki ) @ #j) ⇒ ¬(#j < #i)) ∧
     (((∀ #j. (Reveal_rnd( r ) @ #j) ⇒ ⊥) ∨
       (∀ #j. (Reveal_prfk( tpk ) @ #j) ⇒ ⊥))))))"
*/
by sorry

lemma UKS_on_initiator_resistance [reuse]:
  all-traces
  "∀ pki pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb ka k tpk1 tpk2 r1 r2
     r3 #i #j #i1.
    (((((((IKeys( <pki, pkr1, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
          (PRFGen( tpk1, r3, kb ) @ #i1)) ∧
         (#i1 < #i)) ∧
        (RKeys( <pki, pkr2, peki2, psk2, ck, kb, ka, k> ) @ #j)) ∧
       (PRFGen( tpk2, r1, ka ) @ #j)) ∧
      (PRFGen( tpk2, r2, k ) @ #j)) ∧
     (¬((((((∃ #j1. Reveal_AK( pkr1 ) @ #j1) ∨
            ((∃ #j1. Reveal_rnd( r3 ) @ #j1) ∧
             (∃ #j1. Reveal_prfk( tpk1 ) @ #j1))) ∧
           ((∃ #j1. Reveal_AK( pki ) @ #j1) ∨
            ((∃ #j1. Reveal_rnd( r1 ) @ #j1) ∧
             (∃ #j1. Reveal_prfk( tpk2 ) @ #j1)))) ∧
          ((∃ #j1. Reveal_EphK( peki1 ) @ #j1) ∨
           ((∃ #j1. Reveal_rnd( r2 ) @ #j1) ∧
            (∃ #j1. Reveal_prfk( tpk2 ) @ #j1)))) ∧
         (∃ #j2. Reveal_PSK( psk1 ) @ #j2)) ∧
        (∃ #j2. Reveal_PSK( psk2 ) @ #j2)))) ⇒
    (((pkr1 = pkr2) ∧ (peki1 = peki2)) ∧ (psk1 = psk2))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb ka k tpk1 tpk2 r1 r2
   r3 #i #j #i1.
  (IKeys( <pki, pkr1, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk1, r3, kb ) @ #i1) ∧
  (RKeys( <pki, pkr2, peki2, psk2, ck, kb, ka, k> ) @ #j) ∧
  (PRFGen( tpk2, r1, ka ) @ #j) ∧
  (PRFGen( tpk2, r2, k ) @ #j)
 ∧
  (#i1 < #i) ∧
  ((((∀ #j1. (Reveal_AK( pkr1 ) @ #j1) ⇒ ⊥) ∧
     (((∀ #j1. (Reveal_rnd( r3 ) @ #j1) ⇒ ⊥) ∨
       (∀ #j1. (Reveal_prfk( tpk1 ) @ #j1) ⇒ ⊥)))) ∨
    ((∀ #j1. (Reveal_AK( pki ) @ #j1) ⇒ ⊥) ∧
     (((∀ #j1. (Reveal_rnd( r1 ) @ #j1) ⇒ ⊥) ∨
       (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))) ∨
    ((∀ #j1. (Reveal_EphK( peki1 ) @ #j1) ⇒ ⊥) ∧
     (((∀ #j1. (Reveal_rnd( r2 ) @ #j1) ⇒ ⊥) ∨
       (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))) ∨
    (∀ #j2. (Reveal_PSK( psk1 ) @ #j2) ⇒ ⊥) ∨
    (∀ #j2. (Reveal_PSK( psk2 ) @ #j2) ⇒ ⊥))) ∧
  (((¬(pkr1 = pkr2)) ∨ (¬(peki1 = peki2)) ∨ (¬(psk1 = psk2))))"
*/
by sorry

lemma UKS_on_initiator_with_default_psk [reuse]:
  all-traces
  "¬(∃ pki pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb ka k #i #j #i1.
      ((((IKeys( <pki, pkr1, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
         (RKeys( <pki, pkr2, peki2, psk2, ck, kb, ka, k> ) @ #j)) ∧
        (DefaultPSK( pki, psk1 ) @ #i1)) ∧
       (DefaultPSK( pkr1, psk1 ) @ #i1)) ∧
      (¬(pkr1 = pkr2)))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr1 pkr2 peki1 peki2 psk1 psk2 ck kb ka k #i #j #i1.
  (IKeys( <pki, pkr1, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
  (RKeys( <pki, pkr2, peki2, psk2, ck, kb, ka, k> ) @ #j) ∧
  (DefaultPSK( pki, psk1 ) @ #i1) ∧
  (DefaultPSK( pkr1, psk1 ) @ #i1)
 ∧
  ¬(pkr1 = pkr2)"
*/
by sorry

lemma UKS_on_responder_resistance [reuse]:
  all-traces
  "¬(∃ pki1 pki2 pkr peki1 peki2 psk1 psk2 ck kb ka k #i #j.
      ((IKeys( <pki1, pkr, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
       (RKeys( <pki2, pkr, peki2, psk2, ck, kb, ka, k> ) @ #j)) ∧
      (¬(pki1 = pki2)))"
/*
guarded formula characterizing all counter-examples:
"∃ pki1 pki2 pkr peki1 peki2 psk1 psk2 ck kb ka k #i #j.
  (IKeys( <pki1, pkr, peki1, psk1, ck, kb, ka, k> ) @ #i) ∧
  (RKeys( <pki2, pkr, peki2, psk2, ck, kb, ka, k> ) @ #j)
 ∧
  ¬(pki1 = pki2)"
*/
by sorry

lemma key_init_secrecy [reuse]:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk r #i #j #i1.
    (((IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
      (PRFGen( tpk, r, kb ) @ #i1)) ∧
     (K( ck ) @ #j)) ⇒
    ((∃ #j1. Reveal_PSK( psk ) @ #j1) ∧
     ((∃ #j1. Reveal_AK( pkr ) @ #j1) ∨
      ((∃ #j1. Reveal_rnd( r ) @ #j1) ∧
       (∃ #j1. Reveal_prfk( tpk ) @ #j1))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk r #i #j #i1.
  (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk, r, kb ) @ #i1) ∧
  (K( ck ) @ #j)
 ∧
  ((∀ #j1. (Reveal_PSK( psk ) @ #j1) ⇒ ⊥) ∨
   ((∀ #j1. (Reveal_AK( pkr ) @ #j1) ⇒ ⊥) ∧
    (((∀ #j1. (Reveal_rnd( r ) @ #j1) ⇒ ⊥) ∨
      (∀ #j1. (Reveal_prfk( tpk ) @ #j1) ⇒ ⊥)))))"
*/
by sorry

lemma key_resp_secrecy [reuse]:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk r #i #j #i1.
    ((((RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
       (PRFGen( tpk, r, ka ) @ #i1)) ∧
      (#i1 < #i)) ∧
     (K( ck ) @ #j)) ⇒
    ((∃ #j1. Reveal_PSK( psk ) @ #j1) ∧
     ((∃ #j1. Reveal_AK( pki ) @ #j1) ∨
      ((∃ #j1. Reveal_rnd( r ) @ #j1) ∧
       (∃ #j1. Reveal_prfk( tpk ) @ #j1))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk r #i #j #i1.
  (RConfirm( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk, r, ka ) @ #i1) ∧
  (K( ck ) @ #j)
 ∧
  (#i1 < #i) ∧
  (((∀ #j1. (Reveal_PSK( psk ) @ #j1) ⇒ ⊥) ∨
    ((∀ #j1. (Reveal_AK( pki ) @ #j1) ⇒ ⊥) ∧
     (((∀ #j1. (Reveal_rnd( r ) @ #j1) ⇒ ⊥) ∨
       (∀ #j1. (Reveal_prfk( tpk ) @ #j1) ⇒ ⊥))))))"
*/
by sorry

lemma key_secrecy:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk1 tpk2 r1 r2 r3 #i #i2 #i3 #i4.
    ((((((IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
         (PRFGen( tpk1, r1, kb ) @ #i4)) ∧
        (RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i2)) ∧
       (PRFGen( tpk2, r2, ka ) @ #i2)) ∧
      (PRFGen( tpk2, r3, k ) @ #i2)) ∧
     (K( ck ) @ #i3)) ⇒
    ((∃ #j. Reveal_PSK( psk ) @ #j) ∧
     ((((∃ #j1. Reveal_AK( pki ) @ #j1) ∨
        ((∃ #j1. Reveal_rnd( r2 ) @ #j1) ∧
         (∃ #j1. Reveal_prfk( tpk2 ) @ #j1))) ∧
       ((∃ #j1. Reveal_AK( pkr ) @ #j1) ∨
        ((∃ #j1. Reveal_rnd( r1 ) @ #j1) ∧
         (∃ #j1. Reveal_prfk( tpk1 ) @ #j1)))) ∧
      ((∃ #j1. Reveal_EphK( peki ) @ #j1) ∨
       ((∃ #j1. Reveal_rnd( r3 ) @ #j1) ∧
        (∃ #j1. Reveal_prfk( tpk2 ) @ #j1)))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk1 tpk2 r1 r2 r3 #i #i2 #i3 #i4.
  (IKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk1, r1, kb ) @ #i4) ∧
  (RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i2) ∧
  (PRFGen( tpk2, r2, ka ) @ #i2) ∧
  (PRFGen( tpk2, r3, k ) @ #i2) ∧
  (K( ck ) @ #i3)
 ∧
  ((∀ #j. (Reveal_PSK( psk ) @ #j) ⇒ ⊥) ∨
   ((∀ #j1. (Reveal_AK( pki ) @ #j1) ⇒ ⊥) ∧
    (((∀ #j1. (Reveal_rnd( r2 ) @ #j1) ⇒ ⊥) ∨
      (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))) ∨
   ((∀ #j1. (Reveal_AK( pkr ) @ #j1) ⇒ ⊥) ∧
    (((∀ #j1. (Reveal_rnd( r1 ) @ #j1) ⇒ ⊥) ∨
      (∀ #j1. (Reveal_prfk( tpk1 ) @ #j1) ⇒ ⊥)))) ∨
   ((∀ #j1. (Reveal_EphK( peki ) @ #j1) ⇒ ⊥) ∧
    (((∀ #j1. (Reveal_rnd( r3 ) @ #j1) ⇒ ⊥) ∨
      (∀ #j1. (Reveal_prfk( tpk2 ) @ #j1) ⇒ ⊥)))))"
*/
by sorry

lemma encap_init_secrecy [sources]:
  all-traces
  "∀ pki pkr peki psk kb tpk r #i.
    ((((ISend( <pki, pkr, peki, psk, kb> ) @ #i) ∧
       (PRFGen( tpk, r, kb ) @ #i)) ∧
      (¬(∃ #j. Reveal_AK( pkr ) @ #j))) ∧
     (∃ #j. K( kb ) @ #j)) ⇒
    ((∃ #j. Reveal_rnd( r ) @ #j) ∧ (∃ #j. Reveal_prfk( tpk ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk kb tpk r #i.
  (ISend( <pki, pkr, peki, psk, kb> ) @ #i) ∧
  (PRFGen( tpk, r, kb ) @ #i)
 ∧
  (∀ #j. (Reveal_AK( pkr ) @ #j) ⇒ ⊥) ∧
  (∃ #j. (K( kb ) @ #j)) ∧
  (((∀ #j. (Reveal_rnd( r ) @ #j) ⇒ ⊥) ∨
    (∀ #j. (Reveal_prfk( tpk ) @ #j) ⇒ ⊥)))"
*/
by sorry

lemma encap_resp_secrecy [sources]:
  all-traces
  "∀ pki pkr peki psk ck kb ka k tpk r #i.
    ((((RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
       (PRFGen( tpk, r, ka ) @ #i)) ∧
      (¬(∃ #j. Reveal_AK( pki ) @ #j))) ∧
     (∃ #j. K( ka ) @ #j)) ⇒
    ((∃ #j. Reveal_rnd( r ) @ #j) ∧ (∃ #j. Reveal_prfk( tpk ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk ck kb ka k tpk r #i.
  (RKeys( <pki, pkr, peki, psk, ck, kb, ka, k> ) @ #i) ∧
  (PRFGen( tpk, r, ka ) @ #i)
 ∧
  (∀ #j. (Reveal_AK( pki ) @ #j) ⇒ ⊥) ∧
  (∃ #j. (K( ka ) @ #j)) ∧
  (((∀ #j. (Reveal_rnd( r ) @ #j) ⇒ ⊥) ∨
    (∀ #j. (Reveal_prfk( tpk ) @ #j) ⇒ ⊥)))"
*/
by sorry

lemma identity_hiding:
  all-traces
  "∀ pki pkr peki psk kb surrogate tpk r #i #j.
    ((((ISend( <pki, pkr, peki, psk, kb> ) @ #i) ∧
       (Identity_Surrogate( surrogate ) @ #i)) ∧
      (PRFGen( tpk, r, kb ) @ #i)) ∧
     (K( surrogate ) @ #j)) ⇒
    ((∃ #j.1. Reveal_AK( pkr ) @ #j.1) ∨
     ((∃ #j.1. Reveal_rnd( r ) @ #j.1) ∧
      (∃ #j.1. Reveal_prfk( tpk ) @ #j.1)))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk kb surrogate tpk r #i #j.
  (ISend( <pki, pkr, peki, psk, kb> ) @ #i) ∧
  (Identity_Surrogate( surrogate ) @ #i) ∧
  (PRFGen( tpk, r, kb ) @ #i) ∧
  (K( surrogate ) @ #j)
 ∧
  (∀ #j.1. (Reveal_AK( pkr ) @ #j.1) ⇒ ⊥) ∧
  (((∀ #j.1. (Reveal_rnd( r ) @ #j.1) ⇒ ⊥) ∨
    (∀ #j.1. (Reveal_prfk( tpk ) @ #j.1) ⇒ ⊥)))"
*/
by sorry

lemma replay_attack_resistance:
  all-traces
  "∀ pki pkr peki peki2 psk psk2 cr cr2 kb ka ka2 k k2 ts ts2 tpk r
     #i #i1 #j.
    (((((((((RKeys( <pki, pkr, peki, psk, cr, kb, ka, k> ) @ #i) ∧
            (OnlyOnce( pki, pkr, ts ) @ #i)) ∧
           (ISend( <pki, pkr, peki, psk, kb> ) @ #i1)) ∧
          (#i1 < #i)) ∧
         (PRFGen( tpk, r, kb ) @ #i1)) ∧
        (RKeys( <pki, pkr, peki2, psk2, cr2, kb, ka2, k2> ) @ #j)) ∧
       (#i < #j)) ∧
      (OnlyOnce( pki, pkr, ts2 ) @ #j)) ∧
     (¬(ts = ts2))) ⇒
    ((¬(∃ #j1.
         ((ISend( <pki, pkr, peki2, psk2, kb> ) @ #j1) ∧ (#j1 < #j)) ∧
         (#i < #j1))) ∧
     ((∃ #j1. (Reveal_AK( pkr ) @ #j1) ∧ (#j1 < #j)) ∨
      ((∃ #j1. Reveal_rnd( r ) @ #j1) ∧
       (∃ #j1. Reveal_prfk( tpk ) @ #j1))))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki peki2 psk psk2 cr cr2 kb ka ka2 k k2 ts ts2 tpk r
   #i #i1 #j.
  (RKeys( <pki, pkr, peki, psk, cr, kb, ka, k> ) @ #i) ∧
  (OnlyOnce( pki, pkr, ts ) @ #i) ∧
  (ISend( <pki, pkr, peki, psk, kb> ) @ #i1) ∧
  (PRFGen( tpk, r, kb ) @ #i1) ∧
  (RKeys( <pki, pkr, peki2, psk2, cr2, kb, ka2, k2> ) @ #j) ∧
  (OnlyOnce( pki, pkr, ts2 ) @ #j)
 ∧
  (#i1 < #i) ∧
  (#i < #j) ∧
  (¬(ts = ts2)) ∧
  (((∃ #j1.
      (ISend( <pki, pkr, peki2, psk2, kb> ) @ #j1)
     ∧
      (#j1 < #j) ∧ (#i < #j1)) ∨
    ((∀ #j1. (Reveal_AK( pkr ) @ #j1) ⇒ ¬(#j1 < #j)) ∧
     (((∀ #j1. (Reveal_rnd( r ) @ #j1) ⇒ ⊥) ∨
       (∀ #j1. (Reveal_prfk( tpk ) @ #j1) ⇒ ⊥))))))"
*/
by sorry

lemma dos_resistance:
  all-traces
  "∀ pki pkr peki psk cr kb ka k #i.
    ((RKeys( <pki, pkr, peki, psk, cr, kb, ka, k> ) @ #i) ∧
     (¬(∃ pki.1 pkr.1 peki1 psk1 #j.
         (ISend( <pki.1, pkr.1, peki1, psk1, kb> ) @ #j) ∧ (#j < #i)))) ⇒
    (∃ #j. (Reveal_PSK( psk ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ pki pkr peki psk cr kb ka k #i.
  (RKeys( <pki, pkr, peki, psk, cr, kb, ka, k> ) @ #i)
 ∧
  (∀ pki.1 pkr.1 peki1 psk1 #j.
    (ISend( <pki.1, pkr.1, peki1, psk1, kb> ) @ #j) ⇒ ¬(#j < #i)) ∧
  (∀ #j. (Reveal_PSK( psk ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

/* All well-formedness checks were successful. */

end